<html lang="pt-BR"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6IjExYjc0YTUyNzgwMDk5ZjEzNDY0MmNlZWM3ZGE4MjNkMTc4MDc2ZjIiLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIwMDk5NzA1MjgxODc4MTYxNzAwMyIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjXzNmMjIwZmY4ZDc3OTlhZTdfZGFzaGJvYXJkLXJtYS5odG1sLTE0OCJ9LCJleHAiOjE3NjQ3NzA3NDksImlhdCI6MTc2NDc2NzE0OSwiYWxnIjoiUlMyNTYifQ.dsfrJzmFM8i0ZfbB12k8sQ-vffn2ly7S1HdDNcPb3ygB9HU1FGrUiW6hawLpo2_n7jYqAxvy_nOHti97gYSMyG4NETiMOuk0qI336KYYxRbA4v1HUFbfGkn5k1BkBOD09B4lJA9VOZ4WoWmiKHRtF5kqXjAnlLbSt5SWra3aSMeq1qCvIy91lZC6CLq0IJ5jVCtRvgoqep68DK9NGEDeGCuAq8L5Z9QWSl2O4FW8AcjSizHNScKF7-540d6JVQFoFTlRH_YEZqmY8o6FWNrGG2fNct2mi1SBOrvE6by9BOT2A-sXnxpsKhoeKnIiosNEVUPOipma2xZkjilWRB-OPA","c_3f220ff8d7799ae7_dashboard-rma.html-148")</script><script>'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageTransformModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });
  modelInformation.deprecatedImageModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predict',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predictLongRunning',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash-preview-09-2025","imageModelName":"imagen-4.0-generate-001","imageEditModelName":"gemini-2.5-flash-image-preview","imageTransformModelName":"gemini-2.5-flash-image-preview","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17","gemini-2.5-flash-preview-05-20"],"deprecatedImageModelNames":["imagen-3.0-generate-001","imagen-3.0-generate-002"]})</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Anal√≠tico de RMA - Inversores Fotovoltaicos (Final v29)</title>
    <!-- SheetJS para leitura de Excel -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #2563eb;
            --primary-light: #3b82f6;
            --primary-dark: #1d4ed8;
            --bg-body: #f3f4f6;
            --bg-card: #ffffff;
            --border: #e5e7eb;
            --text-main: #1f2937;
            --text-muted: #6b7280;
            --danger: #ef4444;
            --success: #10b981;
            --warning-bg: #fef9c3;
            --warning-text: #854d0e;
            --active-filter-bg: #dbeafe;
            --active-filter-text: #1e40af;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Arial, sans-serif; }

        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            padding: 20px;
        }

        /* Layout Grid */
        .container {
            max-width: 1600px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 20px;
        }

        /* Sidebar Filtros */
        .sidebar {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            height: fit-content;
            max-height: 95vh;
            overflow-y: auto;
            position: sticky;
            top: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .filter-group { margin-bottom: 20px; }
        .filter-header { font-weight: bold; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; font-size: 0.9rem; }
        .filter-header button {
            font-size: 0.75rem;
            color: var(--primary);
            background: none;
            border: none;
            cursor: pointer;
            text-decoration: underline;
        }
        
        /* Date Inputs */
        .date-filter-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .date-input-group {
            display: flex;
            flex-direction: column;
        }
        .date-input-group label {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-bottom: 2px;
        }
        .date-input-group input {
            padding: 6px;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-family: inherit;
            color: var(--text-main);
        }

        .checkbox-list {
            max-height: 250px;
            overflow-y: auto;
            border: 1px solid var(--border);
            border-radius: 4px;
            background: #f9fafb;
            padding: 5px;
        }
        .checkbox-item {
            display: flex;
            align-items: flex-start;
            padding: 6px;
            font-size: 0.85rem;
            border-bottom: 1px solid #f3f4f6;
        }
        .checkbox-item:last-child { border-bottom: none; }
        .checkbox-item:hover { background-color: #e5e7eb; }
        .checkbox-item input { margin-right: 8px; margin-top: 3px; }
        .checkbox-item label { cursor: pointer; width: 100%; word-break: break-word; line-height: 1.3; }

        /* Upload Section */
        .upload-section {
            border: 2px dashed var(--primary-light);
            background-color: #eff6ff;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .upload-section:hover { background-color: #dbeafe; border-color: var(--primary-dark); }
        .upload-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            margin-top: 5px;
            width: 100%;
            font-weight: 600;
        }
        #fileInput { display: none; }
        .upload-status { font-size: 0.8rem; color: var(--text-muted); margin-top: 5px; white-space: pre-line; }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 20px;
        }

        .clear-data-btn {
            background: white;
            border: 1px solid var(--danger);
            color: var(--danger);
            width: 100%;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: background 0.2s;
            font-weight: 600;
        }
        .clear-data-btn:hover { background: #fee2e2; }

        .export-html-btn {
            background: var(--success);
            border: none;
            color: white;
            width: 100%;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: background 0.2s;
            font-weight: 600;
            display: none; /* Oculto at√© carregar dados */
        }
        .export-html-btn:hover { background: #059669; }


        /* Main Content */
        .main-content { display: flex; flex-direction: column; gap: 20px; }

        /* Header */
        header { 
            background: var(--bg-card); 
            padding: 15px 20px; 
            border-radius: 8px; 
            border: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        h1 { font-size: 1.4rem; color: #111827; font-weight: 700; }
        p.subtitle { color: var(--text-muted); font-size: 0.9rem; margin-top: 2px; }

        /* Active Filters Bar */
        .active-filters-bar {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            min-height: 0px; /* Expands when content exists */
        }
        .active-filter-chip {
            background-color: var(--active-filter-bg);
            color: var(--active-filter-text);
            border: 1px solid var(--primary-light);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            animation: fadeIn 0.3s ease;
        }
        .active-filter-chip button {
            background: none;
            border: none;
            color: var(--active-filter-text);
            font-weight: bold;
            cursor: pointer;
            font-size: 1rem;
            line-height: 1;
        }
        .active-filter-chip button:hover { color: var(--primary-dark); }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        /* KPI Cards */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        .kpi-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        .kpi-card:hover { transform: translateY(-2px); box-shadow: 0 4px 6px rgba(0,0,0,0.05); border-color: var(--primary-light); }
        .kpi-value { font-size: 2rem; font-weight: 800; color: var(--primary); margin: 5px 0; }
        .kpi-label { font-size: 0.85rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600; }

        /* Insights Box */
        .insights-box {
            background-color: var(--warning-bg);
            border: 1px solid #fde047;
            border-radius: 8px;
            padding: 15px 20px;
            color: var(--warning-text);
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        .insights-title { font-weight: bold; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
        .insight-item { font-size: 0.95rem; margin-bottom: 4px; }
        .insight-item strong { font-weight: 600; }

        /* Chart Sections */
        .chart-section {
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .chart-title { font-size: 1.1rem; font-weight: 600; margin-bottom: 15px; color: #374151; border-left: 4px solid var(--primary); padding-left: 10px; }
        .chart-subtitle { font-size: 0.8rem; color: var(--text-muted); margin-top: -10px; margin-bottom: 15px; padding-left: 14px; font-style: italic; }

        /* Custom Bar Chart CSS */
        .chart-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-height: 600px;
            overflow-y: auto;
            padding-right: 5px;
        }
        .bar-row {
            display: grid;
            grid-template-columns: 280px 1fr 140px;
            align-items: center;
            gap: 15px;
            font-size: 0.9rem;
            border-bottom: 1px solid #f3f4f6;
            padding-bottom: 8px;
            cursor: pointer; /* Indica interatividade */
            transition: background 0.2s;
            border-radius: 4px;
            padding: 5px;
        }
        .bar-row:hover { background-color: #f8fafc; }
        .bar-row.selected { background-color: #eff6ff; border: 1px solid var(--primary-light); }

        .bar-label-group {
            display: flex;
            flex-direction: column;
            justify-content: center;
            text-align: right;
            padding-right: 10px;
            line-height: 1.2;
        }
        .bar-label-main {
            font-weight: 600;
            color: #374151;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .bar-label-sub {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 2px;
            font-weight: 500;
        }
        .bar-track {
            background-color: #f3f4f6;
            height: 24px;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }
        .bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-light), var(--primary));
            width: 0%; /* Animado via JS */
            transition: width 1s ease-out;
            border-radius: 12px;
            position: relative;
        }
        .bar-fill:hover { filter: brightness(1.1); }
        .bar-value {
            font-weight: bold;
            color: var(--text-main);
            font-size: 0.85rem;
            text-align: right;
        }
        .bar-value-sub {
            font-size: 0.75rem;
            color: var(--text-muted);
            font-weight: normal;
            text-align: right;
        }

        /* Responsive adjustments */
        @media (max-width: 1024px) {
            .container { grid-template-columns: 1fr; }
            .sidebar { position: static; max-height: none; }
            .bar-row { grid-template-columns: 200px 1fr 120px; }
        }

        @media (max-width: 600px) {
            .bar-row { display: flex; flex-direction: column; align-items: flex-start; gap: 4px; margin-bottom: 10px; padding-bottom: 10px; }
            .bar-track { width: 100%; }
            .bar-label-group { text-align: left; padding-right: 0; width: 100%; }
            .bar-value, .bar-value-sub { align-self: flex-start; text-align: left; }
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: var(--text-muted);
            font-style: italic;
        }
    </style>
</head>
<body>

<div class="container">
    <!-- Sidebar Filters -->
    <aside class="sidebar">
        <!-- File Upload Section -->
        <div class="upload-section" onclick="document.getElementById('fileInput').click()">
            <div>üìÇ <strong>1. Carregar Arquivos Excel</strong></div>
            <div style="font-size:0.75rem; margin:5px 0; color: #666;">
                Colunas: "Data Venda", "Data RMA"<br>
                Arquivos: vendas.xlsx, defeitos.xlsx, regional.xlsx
            </div>
            <button class="upload-btn">Escolher Arquivos</button>
            <input type="file" id="fileInput" multiple="" accept=".xlsx, .xls, .csv" onchange="handleFileUpload(event)">
            <div id="upload-status" class="upload-status">Processando...</div>
        </div>
        
        <div class="action-buttons">
            <button class="export-html-btn" id="export-btn" onclick="exportStandaloneHTML()" style="display: block;">üíæ 2. Exportar com Dados</button>
            <button class="clear-data-btn" onclick="clearSavedData()">üóëÔ∏è Limpar Tudo</button>
        </div>

        <h3 style="margin-top: 25px; margin-bottom: 15px; color: #111827;">Filtros</h3>
        
        <!-- Novo Filtro de Data -->
        <div class="filter-group">
            <div class="filter-header">Per√≠odo de RMA</div>
            <div class="date-filter-container">
                <div class="date-input-group">
                    <label>De:</label>
                    <input type="date" id="start-date" onchange="handleDateChange()">
                </div>
                <div class="date-input-group">
                    <label>At√©:</label>
                    <input type="date" id="end-date" onchange="handleDateChange()">
                </div>
            </div>
        </div>

        <div class="filter-group">
            <div class="filter-header">
                Fabricantes
                <div>
                    <button onclick="toggleAll('manufacturers', true)">Todos</button> | 
                    <button onclick="toggleAll('manufacturers', false)">Nenhum</button>
                </div>
            </div>
            <div class="checkbox-list" id="filter-manufacturers"><div class="checkbox-item"><input type="checkbox" id="manufacturers-AUXSOL" value="AUXSOL"><label for="manufacturers-AUXSOL">AUXSOL</label></div><div class="checkbox-item"><input type="checkbox" id="manufacturers-DEYE" value="DEYE"><label for="manufacturers-DEYE">DEYE</label></div><div class="checkbox-item"><input type="checkbox" id="manufacturers-SOFAR" value="SOFAR"><label for="manufacturers-SOFAR">SOFAR</label></div><div class="checkbox-item"><input type="checkbox" id="manufacturers-SOLIS" value="SOLIS"><label for="manufacturers-SOLIS">SOLIS</label></div><div class="checkbox-item"><input type="checkbox" id="manufacturers-SOLPLANET" value="SOLPLANET"><label for="manufacturers-SOLPLANET">SOLPLANET</label></div><div class="checkbox-item"><input type="checkbox" id="manufacturers-TSUNESS" value="TSUNESS"><label for="manufacturers-TSUNESS">TSUNESS</label></div></div>
        </div>

        <div class="filter-group">
            <div class="filter-header">
                Modelos
                <div>
                    <button onclick="toggleAll('models', true)">Todos</button> | 
                    <button onclick="toggleAll('models', false)">Nenhum</button>
                </div>
            </div>
            <div class="checkbox-list" id="filter-models"><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR AUXSOL ASN-10SL C/ AFCI" value="INVERSOR AUXSOL ASN-10SL C/ AFCI"><label for="models-INVERSOR AUXSOL ASN-10SL C/ AFCI">INVERSOR AUXSOL ASN-10SL C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR AUXSOL ASN-3SL C/ AFCI" value="INVERSOR AUXSOL ASN-3SL C/ AFCI"><label for="models-INVERSOR AUXSOL ASN-3SL C/ AFCI">INVERSOR AUXSOL ASN-3SL C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR AUXSOL ASN-6SL-G2 C/ AFCI" value="INVERSOR AUXSOL ASN-6SL-G2 C/ AFCI"><label for="models-INVERSOR AUXSOL ASN-6SL-G2 C/ AFCI">INVERSOR AUXSOL ASN-6SL-G2 C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR AUXSOL ASN-7.5SL C/ AFCI" value="INVERSOR AUXSOL ASN-7.5SL C/ AFCI"><label for="models-INVERSOR AUXSOL ASN-7.5SL C/ AFCI">INVERSOR AUXSOL ASN-7.5SL C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR DEYE SUN-M225G4-EU-Q0-I 2250W" value="INVERSOR DEYE SUN-M225G4-EU-Q0-I 2250W"><label for="models-INVERSOR DEYE SUN-M225G4-EU-Q0-I 2250W">INVERSOR DEYE SUN-M225G4-EU-Q0-I 2250W</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOFAR 10KTLM-G3" value="INVERSOR SOFAR 10KTLM-G3"><label for="models-INVERSOR SOFAR 10KTLM-G3">INVERSOR SOFAR 10KTLM-G3</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOFAR 250KTL-HV" value="INVERSOR SOFAR 250KTL-HV"><label for="models-INVERSOR SOFAR 250KTL-HV">INVERSOR SOFAR 250KTL-HV</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOFAR 4KTLM-G3" value="INVERSOR SOFAR 4KTLM-G3"><label for="models-INVERSOR SOFAR 4KTLM-G3">INVERSOR SOFAR 4KTLM-G3</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOFAR 5KTLM-G3" value="INVERSOR SOFAR 5KTLM-G3"><label for="models-INVERSOR SOFAR 5KTLM-G3">INVERSOR SOFAR 5KTLM-G3</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOFAR 5KTLM-G3 C/ AFCI" value="INVERSOR SOFAR 5KTLM-G3 C/ AFCI"><label for="models-INVERSOR SOFAR 5KTLM-G3 C/ AFCI">INVERSOR SOFAR 5KTLM-G3 C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOFAR 6KTLM-G3 C/ AFCI" value="INVERSOR SOFAR 6KTLM-G3 C/ AFCI"><label for="models-INVERSOR SOFAR 6KTLM-G3 C/ AFCI">INVERSOR SOFAR 6KTLM-G3 C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI" value="INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI"><label for="models-INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI">INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOFAR 75KTLX-G3" value="INVERSOR SOFAR 75KTLX-G3"><label for="models-INVERSOR SOFAR 75KTLX-G3">INVERSOR SOFAR 75KTLX-G3</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOFAR 75KTLX-LV-G4" value="INVERSOR SOFAR 75KTLX-LV-G4"><label for="models-INVERSOR SOFAR 75KTLX-LV-G4">INVERSOR SOFAR 75KTLX-LV-G4</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOFAR 9KTLM-G3" value="INVERSOR SOFAR 9KTLM-G3"><label for="models-INVERSOR SOFAR 9KTLM-G3">INVERSOR SOFAR 9KTLM-G3</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOFAR 9KTLM-G3 C/ AFCI" value="INVERSOR SOFAR 9KTLM-G3 C/ AFCI"><label for="models-INVERSOR SOFAR 9KTLM-G3 C/ AFCI">INVERSOR SOFAR 9KTLM-G3 C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S5-GC15K-LV   C/ AFCI" value="INVERSOR SOLIS S5-GC15K-LV   C/ AFCI"><label for="models-INVERSOR SOLIS S5-GC15K-LV   C/ AFCI">INVERSOR SOLIS S5-GC15K-LV   C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S5-GC25K-LV  C/ AFCI" value="INVERSOR SOLIS S5-GC25K-LV  C/ AFCI"><label for="models-INVERSOR SOLIS S5-GC25K-LV  C/ AFCI">INVERSOR SOLIS S5-GC25K-LV  C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S5-GC37.5K C/ AFCI" value="INVERSOR SOLIS S5-GC37.5K C/ AFCI"><label for="models-INVERSOR SOLIS S5-GC37.5K C/ AFCI">INVERSOR SOLIS S5-GC37.5K C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S5-GC37.5K-LV  C/ AFCI" value="INVERSOR SOLIS S5-GC37.5K-LV  C/ AFCI"><label for="models-INVERSOR SOLIS S5-GC37.5K-LV  C/ AFCI">INVERSOR SOLIS S5-GC37.5K-LV  C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S5-GC37.5K-LV (10 ANOS DE GARANTIA)" value="INVERSOR SOLIS S5-GC37.5K-LV (10 ANOS DE GARANTIA)"><label for="models-INVERSOR SOLIS S5-GC37.5K-LV (10 ANOS DE GARANTIA)">INVERSOR SOLIS S5-GC37.5K-LV (10 ANOS DE GARANTIA)</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S5-GC50K (10 ANOS DE GARANTIA)" value="INVERSOR SOLIS S5-GC50K (10 ANOS DE GARANTIA)"><label for="models-INVERSOR SOLIS S5-GC50K (10 ANOS DE GARANTIA)">INVERSOR SOLIS S5-GC50K (10 ANOS DE GARANTIA)</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S5-GC60K (10 ANOS DE GARANTIA)" value="INVERSOR SOLIS S5-GC60K (10 ANOS DE GARANTIA)"><label for="models-INVERSOR SOLIS S5-GC60K (10 ANOS DE GARANTIA)">INVERSOR SOLIS S5-GC60K (10 ANOS DE GARANTIA)</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S5-GR1P10K (10 ANOS DE GARANTIA)" value="INVERSOR SOLIS S5-GR1P10K (10 ANOS DE GARANTIA)"><label for="models-INVERSOR SOLIS S5-GR1P10K (10 ANOS DE GARANTIA)">INVERSOR SOLIS S5-GR1P10K (10 ANOS DE GARANTIA)</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S5-GR3P20K  C/ AFCI" value="INVERSOR SOLIS S5-GR3P20K  C/ AFCI"><label for="models-INVERSOR SOLIS S5-GR3P20K  C/ AFCI">INVERSOR SOLIS S5-GR3P20K  C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S6-GR1P10K03 C/ AFCI" value="INVERSOR SOLIS S6-GR1P10K03 C/ AFCI"><label for="models-INVERSOR SOLIS S6-GR1P10K03 C/ AFCI">INVERSOR SOLIS S6-GR1P10K03 C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S6-GR1P3K-M (10 ANOS DE GARANTIA)" value="INVERSOR SOLIS S6-GR1P3K-M (10 ANOS DE GARANTIA)"><label for="models-INVERSOR SOLIS S6-GR1P3K-M (10 ANOS DE GARANTIA)">INVERSOR SOLIS S6-GR1P3K-M (10 ANOS DE GARANTIA)</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)" value="INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)"><label for="models-INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)">INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S6-GR1P5K-S C/ AFCI" value="INVERSOR SOLIS S6-GR1P5K-S C/ AFCI"><label for="models-INVERSOR SOLIS S6-GR1P5K-S C/ AFCI">INVERSOR SOLIS S6-GR1P5K-S C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)" value="INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)"><label for="models-INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)">INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S6-GR1P6K-S C/ AFCI" value="INVERSOR SOLIS S6-GR1P6K-S C/ AFCI"><label for="models-INVERSOR SOLIS S6-GR1P6K-S C/ AFCI">INVERSOR SOLIS S6-GR1P6K-S C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)" value="INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)"><label for="models-INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)">INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS SOLIS-50K-LV-5G-PRO (10 ANOS DE GARANTIA)" value="INVERSOR SOLIS SOLIS-50K-LV-5G-PRO (10 ANOS DE GARANTIA)"><label for="models-INVERSOR SOLIS SOLIS-50K-LV-5G-PRO (10 ANOS DE GARANTIA)">INVERSOR SOLIS SOLIS-50K-LV-5G-PRO (10 ANOS DE GARANTIA)</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS SOLIS-75K-5G-PRO (10 ANOS DE GARANTIA)" value="INVERSOR SOLIS SOLIS-75K-5G-PRO (10 ANOS DE GARANTIA)"><label for="models-INVERSOR SOLIS SOLIS-75K-5G-PRO (10 ANOS DE GARANTIA)">INVERSOR SOLIS SOLIS-75K-5G-PRO (10 ANOS DE GARANTIA)</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLIS SOLIS-75K-LV-5G-PRO (10 ANOS DE GARANTIA)" value="INVERSOR SOLIS SOLIS-75K-LV-5G-PRO (10 ANOS DE GARANTIA)"><label for="models-INVERSOR SOLIS SOLIS-75K-LV-5G-PRO (10 ANOS DE GARANTIA)">INVERSOR SOLIS SOLIS-75K-LV-5G-PRO (10 ANOS DE GARANTIA)</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW10000-S" value="INVERSOR SOLPLANET ASW10000-S"><label for="models-INVERSOR SOLPLANET ASW10000-S">INVERSOR SOLPLANET ASW10000-S</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW10000-S C/ AFCI" value="INVERSOR SOLPLANET ASW10000-S C/ AFCI"><label for="models-INVERSOR SOLPLANET ASW10000-S C/ AFCI">INVERSOR SOLPLANET ASW10000-S C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW15K-LT-G2 PRO" value="INVERSOR SOLPLANET ASW15K-LT-G2 PRO"><label for="models-INVERSOR SOLPLANET ASW15K-LT-G2 PRO">INVERSOR SOLPLANET ASW15K-LT-G2 PRO</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW15K-UT-G3 220V C/ AFCI" value="INVERSOR SOLPLANET ASW15K-UT-G3 220V C/ AFCI"><label for="models-INVERSOR SOLPLANET ASW15K-UT-G3 220V C/ AFCI">INVERSOR SOLPLANET ASW15K-UT-G3 220V C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW17K-LT-G2 PRO" value="INVERSOR SOLPLANET ASW17K-LT-G2 PRO"><label for="models-INVERSOR SOLPLANET ASW17K-LT-G2 PRO">INVERSOR SOLPLANET ASW17K-LT-G2 PRO</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW17K-LT-G2 PRO C/ AFCI" value="INVERSOR SOLPLANET ASW17K-LT-G2 PRO C/ AFCI"><label for="models-INVERSOR SOLPLANET ASW17K-LT-G2 PRO C/ AFCI">INVERSOR SOLPLANET ASW17K-LT-G2 PRO C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW20K-LT-G2 PRO C/ AFCI" value="INVERSOR SOLPLANET ASW20K-LT-G2 PRO C/ AFCI"><label for="models-INVERSOR SOLPLANET ASW20K-LT-G2 PRO C/ AFCI">INVERSOR SOLPLANET ASW20K-LT-G2 PRO C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW20K-UT-G3 220V" value="INVERSOR SOLPLANET ASW20K-UT-G3 220V"><label for="models-INVERSOR SOLPLANET ASW20K-UT-G3 220V">INVERSOR SOLPLANET ASW20K-UT-G3 220V</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW20K-UT-G3 220V C/ AFCI" value="INVERSOR SOLPLANET ASW20K-UT-G3 220V C/ AFCI"><label for="models-INVERSOR SOLPLANET ASW20K-UT-G3 220V C/ AFCI">INVERSOR SOLPLANET ASW20K-UT-G3 220V C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW25K-LT-G2 PRO" value="INVERSOR SOLPLANET ASW25K-LT-G2 PRO"><label for="models-INVERSOR SOLPLANET ASW25K-LT-G2 PRO">INVERSOR SOLPLANET ASW25K-LT-G2 PRO</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW25K-LT-G2 PRO C/ AFCI" value="INVERSOR SOLPLANET ASW25K-LT-G2 PRO C/ AFCI"><label for="models-INVERSOR SOLPLANET ASW25K-LT-G2 PRO C/ AFCI">INVERSOR SOLPLANET ASW25K-LT-G2 PRO C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW25K-UT-G3 220V" value="INVERSOR SOLPLANET ASW25K-UT-G3 220V"><label for="models-INVERSOR SOLPLANET ASW25K-UT-G3 220V">INVERSOR SOLPLANET ASW25K-UT-G3 220V</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW3000-S-G2" value="INVERSOR SOLPLANET ASW3000-S-G2"><label for="models-INVERSOR SOLPLANET ASW3000-S-G2">INVERSOR SOLPLANET ASW3000-S-G2</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW3000-S-G2 C/AFCI" value="INVERSOR SOLPLANET ASW3000-S-G2 C/AFCI"><label for="models-INVERSOR SOLPLANET ASW3000-S-G2 C/AFCI">INVERSOR SOLPLANET ASW3000-S-G2 C/AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW33K-LT-G3 C/ AFCI" value="INVERSOR SOLPLANET ASW33K-LT-G3 C/ AFCI"><label for="models-INVERSOR SOLPLANET ASW33K-LT-G3 C/ AFCI">INVERSOR SOLPLANET ASW33K-LT-G3 C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW37.5K-UT-G3 220V" value="INVERSOR SOLPLANET ASW37.5K-UT-G3 220V"><label for="models-INVERSOR SOLPLANET ASW37.5K-UT-G3 220V">INVERSOR SOLPLANET ASW37.5K-UT-G3 220V</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW37.5K-UT-G3 220V C/ AFCI" value="INVERSOR SOLPLANET ASW37.5K-UT-G3 220V C/ AFCI"><label for="models-INVERSOR SOLPLANET ASW37.5K-UT-G3 220V C/ AFCI">INVERSOR SOLPLANET ASW37.5K-UT-G3 220V C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW40K-LT-G3" value="INVERSOR SOLPLANET ASW40K-LT-G3"><label for="models-INVERSOR SOLPLANET ASW40K-LT-G3">INVERSOR SOLPLANET ASW40K-LT-G3</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW5000-S-G2" value="INVERSOR SOLPLANET ASW5000-S-G2"><label for="models-INVERSOR SOLPLANET ASW5000-S-G2">INVERSOR SOLPLANET ASW5000-S-G2</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI" value="INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI"><label for="models-INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI">INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW50K-LT-G2" value="INVERSOR SOLPLANET ASW50K-LT-G2"><label for="models-INVERSOR SOLPLANET ASW50K-LT-G2">INVERSOR SOLPLANET ASW50K-LT-G2</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW50K-LT-G3" value="INVERSOR SOLPLANET ASW50K-LT-G3"><label for="models-INVERSOR SOLPLANET ASW50K-LT-G3">INVERSOR SOLPLANET ASW50K-LT-G3</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW6000-S-G2" value="INVERSOR SOLPLANET ASW6000-S-G2"><label for="models-INVERSOR SOLPLANET ASW6000-S-G2">INVERSOR SOLPLANET ASW6000-S-G2</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW6000-S-G2 C/ AFCI" value="INVERSOR SOLPLANET ASW6000-S-G2 C/ AFCI"><label for="models-INVERSOR SOLPLANET ASW6000-S-G2 C/ AFCI">INVERSOR SOLPLANET ASW6000-S-G2 C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW7300-S C/ AFCI" value="INVERSOR SOLPLANET ASW7300-S C/ AFCI"><label for="models-INVERSOR SOLPLANET ASW7300-S C/ AFCI">INVERSOR SOLPLANET ASW7300-S C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW8000-S" value="INVERSOR SOLPLANET ASW8000-S"><label for="models-INVERSOR SOLPLANET ASW8000-S">INVERSOR SOLPLANET ASW8000-S</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR SOLPLANET ASW8000-S C/ AFCI" value="INVERSOR SOLPLANET ASW8000-S C/ AFCI"><label for="models-INVERSOR SOLPLANET ASW8000-S C/ AFCI">INVERSOR SOLPLANET ASW8000-S C/ AFCI</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR TSUNESS TSOL-MP3000" value="INVERSOR TSUNESS TSOL-MP3000"><label for="models-INVERSOR TSUNESS TSOL-MP3000">INVERSOR TSUNESS TSOL-MP3000</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR TSUNESS TSOL-MS2000 (0.5M)" value="INVERSOR TSUNESS TSOL-MS2000 (0.5M)"><label for="models-INVERSOR TSUNESS TSOL-MS2000 (0.5M)">INVERSOR TSUNESS TSOL-MS2000 (0.5M)</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR TSUNESS TSOL-MX2250" value="INVERSOR TSUNESS TSOL-MX2250"><label for="models-INVERSOR TSUNESS TSOL-MX2250">INVERSOR TSUNESS TSOL-MX2250</label></div><div class="checkbox-item"><input type="checkbox" id="models-INVERSOR TSUNESS TSOL-MX3000D" value="INVERSOR TSUNESS TSOL-MX3000D"><label for="models-INVERSOR TSUNESS TSOL-MX3000D">INVERSOR TSUNESS TSOL-MX3000D</label></div></div>
        </div>
    </aside>

    <!-- Dashboard Content -->
    <main class="main-content">
        <header>
            <div>
                <h1>Dashboard RMA</h1>
                <p class="subtitle">An√°lise T√©cnica de Garantias e Qualidade</p>
            </div>
            <div style="text-align: right; font-size: 0.8rem; color: var(--text-muted);">
                <span id="last-update">Dados carregados</span>
            </div>
        </header>

        <!-- Active Interactive Filters -->
        <section class="active-filters-bar" id="active-filters-container">
            <!-- Injetado via JS quando houver filtro interativo -->
        </section>

        <!-- KPI Cards -->
        <section class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-label">Total RMAs</div>
                <div class="kpi-value" id="kpi-total-rma">493</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-label">Total Vendas</div>
                <div class="kpi-value" id="kpi-total-sales">69.527</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-label">Taxa M√©dia RMA</div>
                <div class="kpi-value" id="kpi-rate">0.71%</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-label">Estados Afetados</div>
                <div class="kpi-value" id="kpi-states">24</div>
            </div>
        </section>

        <!-- Dynamic Insights -->
        <section class="insights-box" id="insights-container">
            <div class="insights-title">‚ö° Insights Autom√°ticos</div>
            <div id="insights-content"><div class="insight-item">üìä O modelo com maior volume absoluto √© <strong>INVERSOR TSUNESS TSOL-MX2250</strong> (98 casos).</div><div class="insight-item">üö® A maior taxa de falha (vendas &gt; 3) √© do <strong>INVERSOR SOLPLANET ASW50K-LT-G2</strong> (33.33%).</div><div class="insight-item">üîß O defeito mais comum √© <strong>[INV] Inversor parou de funcionar</strong> (86 casos).</div><div class="insight-item">üìç <strong>GO</strong> √© o estado com maior volume absoluto de garantias (45).</div></div>
        </section>

        <!-- Charts -->
        <section class="chart-section">
            <div class="chart-title">1. Taxa de RMA por Modelo (%)</div>
            <div class="chart-subtitle">Ordenado do maior percentual de falha para o menor</div>
            <div class="chart-container" id="chart-models"><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW40K-LT-G3">INVERSOR SOLPLANET ASW40K-LT-G3</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 100%;" data-width="100%"></div></div>
                    <div>
                        <div class="bar-value">33.33% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 3</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW50K-LT-G2">INVERSOR SOLPLANET ASW50K-LT-G2</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 100%;" data-width="100%"></div></div>
                    <div>
                        <div class="bar-value">33.33% (2 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 6</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOFAR 4KTLM-G3">INVERSOR SOFAR 4KTLM-G3</div>
                        <div class="bar-label-sub">SOFAR</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 100%;" data-width="100%"></div></div>
                    <div>
                        <div class="bar-value">33.33% (2 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 6</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOFAR 75KTLX-G3">INVERSOR SOFAR 75KTLX-G3</div>
                        <div class="bar-label-sub">SOFAR</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 81.8182%;" data-width="81.81818181818183%"></div></div>
                    <div>
                        <div class="bar-value">27.27% (6 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 22</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS S5-GC50K (10 ANOS DE GARANTIA)">INVERSOR SOLIS S5-GC50K (10 ANOS DE GARANTIA)</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 75%;" data-width="75.00000000000001%"></div></div>
                    <div>
                        <div class="bar-value">25.00% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 4</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW25K-LT-G2 PRO">INVERSOR SOLPLANET ASW25K-LT-G2 PRO</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 64.8649%;" data-width="64.86486486486487%"></div></div>
                    <div>
                        <div class="bar-value">21.62% (8 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 37</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW20K-UT-G3 220V">INVERSOR SOLPLANET ASW20K-UT-G3 220V</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 52.9412%;" data-width="52.941176470588246%"></div></div>
                    <div>
                        <div class="bar-value">17.65% (3 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 17</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOFAR 10KTLM-G3">INVERSOR SOFAR 10KTLM-G3</div>
                        <div class="bar-label-sub">SOFAR</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 50.8475%;" data-width="50.847457627118644%"></div></div>
                    <div>
                        <div class="bar-value">16.95% (10 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 59</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW25K-UT-G3 220V">INVERSOR SOLPLANET ASW25K-UT-G3 220V</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 50%;" data-width="50%"></div></div>
                    <div>
                        <div class="bar-value">16.67% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 6</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOFAR 9KTLM-G3">INVERSOR SOFAR 9KTLM-G3</div>
                        <div class="bar-label-sub">SOFAR</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 38.7097%;" data-width="38.70967741935484%"></div></div>
                    <div>
                        <div class="bar-value">12.90% (4 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 31</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW50K-LT-G3">INVERSOR SOLPLANET ASW50K-LT-G3</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 30.7692%;" data-width="30.76923076923077%"></div></div>
                    <div>
                        <div class="bar-value">10.26% (4 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 39</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOFAR 5KTLM-G3">INVERSOR SOFAR 5KTLM-G3</div>
                        <div class="bar-label-sub">SOFAR</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 18.75%;" data-width="18.750000000000004%"></div></div>
                    <div>
                        <div class="bar-value">6.25% (3 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 48</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS S5-GR1P10K (10 ANOS DE GARANTIA)">INVERSOR SOLIS S5-GR1P10K (10 ANOS DE GARANTIA)</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 16.0305%;" data-width="16.03053435114504%"></div></div>
                    <div>
                        <div class="bar-value">5.34% (14 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 262</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR TSUNESS TSOL-MP3000">INVERSOR TSUNESS TSOL-MP3000</div>
                        <div class="bar-label-sub">TSUNESS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 12.3521%;" data-width="12.352106010411736%"></div></div>
                    <div>
                        <div class="bar-value">4.12% (87 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 2.113</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOFAR 75KTLX-LV-G4">INVERSOR SOFAR 75KTLX-LV-G4</div>
                        <div class="bar-label-sub">SOFAR</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 11.3208%;" data-width="11.320754716981133%"></div></div>
                    <div>
                        <div class="bar-value">3.77% (2 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 53</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS SOLIS-75K-LV-5G-PRO (10 ANOS DE GARANTIA)">INVERSOR SOLIS SOLIS-75K-LV-5G-PRO (10 ANOS DE GARANTIA)</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 7.69231%;" data-width="7.6923076923076925%"></div></div>
                    <div>
                        <div class="bar-value">2.56% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 39</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW5000-S-G2">INVERSOR SOLPLANET ASW5000-S-G2</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 7.09779%;" data-width="7.097791798107256%"></div></div>
                    <div>
                        <div class="bar-value">2.37% (30 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 1.268</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS SOLIS-75K-5G-PRO (10 ANOS DE GARANTIA)">INVERSOR SOLIS SOLIS-75K-5G-PRO (10 ANOS DE GARANTIA)</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 6.81818%;" data-width="6.818181818181819%"></div></div>
                    <div>
                        <div class="bar-value">2.27% (3 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 132</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS SOLIS-50K-LV-5G-PRO (10 ANOS DE GARANTIA)">INVERSOR SOLIS SOLIS-50K-LV-5G-PRO (10 ANOS DE GARANTIA)</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 5.35714%;" data-width="5.357142857142858%"></div></div>
                    <div>
                        <div class="bar-value">1.79% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 56</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS S6-GR1P3K-M (10 ANOS DE GARANTIA)">INVERSOR SOLIS S6-GR1P3K-M (10 ANOS DE GARANTIA)</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 5.08475%;" data-width="5.084745762711865%"></div></div>
                    <div>
                        <div class="bar-value">1.69% (13 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 767</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR AUXSOL ASN-7.5SL C/ AFCI">INVERSOR AUXSOL ASN-7.5SL C/ AFCI</div>
                        <div class="bar-label-sub">AUXSOL</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 4.91132%;" data-width="4.911323328785812%"></div></div>
                    <div>
                        <div class="bar-value">1.64% (12 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 733</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)">INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 4.44856%;" data-width="4.448563484708064%"></div></div>
                    <div>
                        <div class="bar-value">1.48% (16 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 1.079</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW10000-S">INVERSOR SOLPLANET ASW10000-S</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 3.72517%;" data-width="3.7251655629139075%"></div></div>
                    <div>
                        <div class="bar-value">1.24% (15 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 1.208</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS S5-GC37.5K-LV  C/ AFCI">INVERSOR SOLIS S5-GC37.5K-LV  C/ AFCI</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 3.06122%;" data-width="3.061224489795919%"></div></div>
                    <div>
                        <div class="bar-value">1.02% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 98</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS S5-GC37.5K C/ AFCI">INVERSOR SOLIS S5-GC37.5K C/ AFCI</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 3.06122%;" data-width="3.061224489795919%"></div></div>
                    <div>
                        <div class="bar-value">1.02% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 98</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW8000-S">INVERSOR SOLPLANET ASW8000-S</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 2.66667%;" data-width="2.666666666666667%"></div></div>
                    <div>
                        <div class="bar-value">0.89% (10 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 1.125</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW6000-S-G2">INVERSOR SOLPLANET ASW6000-S-G2</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 2.5108%;" data-width="2.510799136069115%"></div></div>
                    <div>
                        <div class="bar-value">0.84% (31 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 3.704</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI">INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI</div>
                        <div class="bar-label-sub">SOFAR</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 2.47168%;" data-width="2.47167868177137%"></div></div>
                    <div>
                        <div class="bar-value">0.82% (8 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 971</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW25K-LT-G2 PRO C/ AFCI">INVERSOR SOLPLANET ASW25K-LT-G2 PRO C/ AFCI</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 2.24439%;" data-width="2.244389027431422%"></div></div>
                    <div>
                        <div class="bar-value">0.75% (3 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 401</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR TSUNESS TSOL-MX2250">INVERSOR TSUNESS TSOL-MX2250</div>
                        <div class="bar-label-sub">TSUNESS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 2.19141%;" data-width="2.1914132379248663%"></div></div>
                    <div>
                        <div class="bar-value">0.73% (98 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 13.416</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)">INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 2.0339%;" data-width="2.033898305084746%"></div></div>
                    <div>
                        <div class="bar-value">0.68% (8 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 1.180</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS S5-GC25K-LV  C/ AFCI">INVERSOR SOLIS S5-GC25K-LV  C/ AFCI</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 1.94805%;" data-width="1.9480519480519483%"></div></div>
                    <div>
                        <div class="bar-value">0.65% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 154</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS S5-GR3P20K  C/ AFCI">INVERSOR SOLIS S5-GR3P20K  C/ AFCI</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 1.85185%;" data-width="1.851851851851852%"></div></div>
                    <div>
                        <div class="bar-value">0.62% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 162</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW15K-UT-G3 220V C/ AFCI">INVERSOR SOLPLANET ASW15K-UT-G3 220V C/ AFCI</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 1.79641%;" data-width="1.796407185628743%"></div></div>
                    <div>
                        <div class="bar-value">0.60% (3 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 501</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS S5-GC15K-LV   C/ AFCI">INVERSOR SOLIS S5-GC15K-LV   C/ AFCI</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 1.74419%;" data-width="1.7441860465116283%"></div></div>
                    <div>
                        <div class="bar-value">0.58% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 172</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOFAR 6KTLM-G3 C/ AFCI">INVERSOR SOFAR 6KTLM-G3 C/ AFCI</div>
                        <div class="bar-label-sub">SOFAR</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 1.74419%;" data-width="1.7441860465116283%"></div></div>
                    <div>
                        <div class="bar-value">0.58% (2 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 344</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)">INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 1.68015%;" data-width="1.680149346608588%"></div></div>
                    <div>
                        <div class="bar-value">0.56% (9 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 1.607</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW20K-LT-G2 PRO C/ AFCI">INVERSOR SOLPLANET ASW20K-LT-G2 PRO C/ AFCI</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 1.39752%;" data-width="1.3975155279503109%"></div></div>
                    <div>
                        <div class="bar-value">0.47% (3 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 644</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW37.5K-UT-G3 220V C/ AFCI">INVERSOR SOLPLANET ASW37.5K-UT-G3 220V C/ AFCI</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 1.37615%;" data-width="1.3761467889908259%"></div></div>
                    <div>
                        <div class="bar-value">0.46% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 218</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR AUXSOL ASN-10SL C/ AFCI">INVERSOR AUXSOL ASN-10SL C/ AFCI</div>
                        <div class="bar-label-sub">AUXSOL</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 1.33333%;" data-width="1.3333333333333335%"></div></div>
                    <div>
                        <div class="bar-value">0.44% (3 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 675</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW20K-UT-G3 220V C/ AFCI">INVERSOR SOLPLANET ASW20K-UT-G3 220V C/ AFCI</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 1.20724%;" data-width="1.2072434607645879%"></div></div>
                    <div>
                        <div class="bar-value">0.40% (2 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 497</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR TSUNESS TSOL-MS2000 (0.5M)">INVERSOR TSUNESS TSOL-MS2000 (0.5M)</div>
                        <div class="bar-label-sub">TSUNESS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 1.17371%;" data-width="1.1737089201877935%"></div></div>
                    <div>
                        <div class="bar-value">0.39% (15 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 3.834</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW7300-S C/ AFCI">INVERSOR SOLPLANET ASW7300-S C/ AFCI</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 1.10294%;" data-width="1.1029411764705883%"></div></div>
                    <div>
                        <div class="bar-value">0.37% (3 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 816</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS S6-GR1P5K-S C/ AFCI">INVERSOR SOLIS S6-GR1P5K-S C/ AFCI</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 1.0333%;" data-width="1.0332950631458095%"></div></div>
                    <div>
                        <div class="bar-value">0.34% (3 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 871</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW33K-LT-G3 C/ AFCI">INVERSOR SOLPLANET ASW33K-LT-G3 C/ AFCI</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.943396%;" data-width="0.9433962264150947%"></div></div>
                    <div>
                        <div class="bar-value">0.31% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 318</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW17K-LT-G2 PRO C/ AFCI">INVERSOR SOLPLANET ASW17K-LT-G2 PRO C/ AFCI</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.894188%;" data-width="0.8941877794336812%"></div></div>
                    <div>
                        <div class="bar-value">0.30% (2 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 671</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR TSUNESS TSOL-MX3000D">INVERSOR TSUNESS TSOL-MX3000D</div>
                        <div class="bar-label-sub">TSUNESS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.859599%;" data-width="0.8595988538681949%"></div></div>
                    <div>
                        <div class="bar-value">0.29% (5 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 1.745</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW3000-S-G2">INVERSOR SOLPLANET ASW3000-S-G2</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.83632%;" data-width="0.836320191158901%"></div></div>
                    <div>
                        <div class="bar-value">0.28% (7 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 2.511</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOFAR 5KTLM-G3 C/ AFCI">INVERSOR SOFAR 5KTLM-G3 C/ AFCI</div>
                        <div class="bar-label-sub">SOFAR</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.828729%;" data-width="0.8287292817679558%"></div></div>
                    <div>
                        <div class="bar-value">0.28% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 362</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS S6-GR1P6K-S C/ AFCI">INVERSOR SOLIS S6-GR1P6K-S C/ AFCI</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.783972%;" data-width="0.7839721254355402%"></div></div>
                    <div>
                        <div class="bar-value">0.26% (3 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 1.148</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOFAR 9KTLM-G3 C/ AFCI">INVERSOR SOFAR 9KTLM-G3 C/ AFCI</div>
                        <div class="bar-label-sub">SOFAR</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.702576%;" data-width="0.7025761124121782%"></div></div>
                    <div>
                        <div class="bar-value">0.23% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 427</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLIS S6-GR1P10K03 C/ AFCI">INVERSOR SOLIS S6-GR1P10K03 C/ AFCI</div>
                        <div class="bar-label-sub">SOLIS</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.660793%;" data-width="0.6607929515418504%"></div></div>
                    <div>
                        <div class="bar-value">0.22% (3 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 1.362</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR AUXSOL ASN-6SL-G2 C/ AFCI">INVERSOR AUXSOL ASN-6SL-G2 C/ AFCI</div>
                        <div class="bar-label-sub">AUXSOL</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.482703%;" data-width="0.4827031375703943%"></div></div>
                    <div>
                        <div class="bar-value">0.16% (2 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 1.243</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR AUXSOL ASN-3SL C/ AFCI">INVERSOR AUXSOL ASN-3SL C/ AFCI</div>
                        <div class="bar-label-sub">AUXSOL</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.476948%;" data-width="0.47694753577106525%"></div></div>
                    <div>
                        <div class="bar-value">0.16% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 629</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI">INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.464796%;" data-width="0.4647960061972801%"></div></div>
                    <div>
                        <div class="bar-value">0.15% (9 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 5.809</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR DEYE SUN-M225G4-EU-Q0-I 2250W">INVERSOR DEYE SUN-M225G4-EU-Q0-I 2250W</div>
                        <div class="bar-label-sub">DEYE</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.404449%;" data-width="0.404448938321537%"></div></div>
                    <div>
                        <div class="bar-value">0.13% (4 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 2.967</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW3000-S-G2 C/AFCI">INVERSOR SOLPLANET ASW3000-S-G2 C/AFCI</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.31679%;" data-width="0.31678986272439286%"></div></div>
                    <div>
                        <div class="bar-value">0.11% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 947</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW6000-S-G2 C/ AFCI">INVERSOR SOLPLANET ASW6000-S-G2 C/ AFCI</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.310238%;" data-width="0.3102378490175802%"></div></div>
                    <div>
                        <div class="bar-value">0.10% (5 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 4.835</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW8000-S C/ AFCI">INVERSOR SOLPLANET ASW8000-S C/ AFCI</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.154639%;" data-width="0.154639175257732%"></div></div>
                    <div>
                        <div class="bar-value">0.05% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 1.940</div>
                    </div>
                </div><div class="bar-row ">
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="INVERSOR SOLPLANET ASW10000-S C/ AFCI">INVERSOR SOLPLANET ASW10000-S C/ AFCI</div>
                        <div class="bar-label-sub">SOLPLANET</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0.0956327%;" data-width="0.09563277016257571%"></div></div>
                    <div>
                        <div class="bar-value">0.03% (1 RMAs)</div>
                        <div class="bar-value-sub">Vendas: 3.137</div>
                    </div>
                </div></div>
        </section>

        <section class="chart-section">
            <div class="chart-title">2. Top 10 Defeitos Principais</div>
            <div class="chart-subtitle">Clique no defeito para filtrar produtos</div>
            <div class="chart-container" id="chart-defects"><div class="bar-row ">
                    <div class="bar-label-main" title="[INV] Inversor parou de funcionar" style="text-align:right; padding-right:10px;">[INV] Inversor parou de funcionar</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 100%;" data-width="100%"></div></div>
                    <div class="bar-value">86 (16.76%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="[INV] Falha Interna" style="text-align:right; padding-right:10px;">[INV] Falha Interna</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 87.2093%;" data-width="87.20930232558139%"></div></div>
                    <div class="bar-value">75 (14.62%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="[MIC] Falha Ponte H" style="text-align:right; padding-right:10px;">[MIC] Falha Ponte H</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 66.2791%;" data-width="66.27906976744185%"></div></div>
                    <div class="bar-value">57 (11.11%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="[INV] Inversor n√£o liga" style="text-align:right; padding-right:10px;">[INV] Inversor n√£o liga</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 45.3488%;" data-width="45.348837209302324%"></div></div>
                    <div class="bar-value">39 (7.60%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="[INV] Falha de rel√©" style="text-align:right; padding-right:10px;">[INV] Falha de rel√©</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 43.0233%;" data-width="43.02325581395349%"></div></div>
                    <div class="bar-value">37 (7.21%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="[INV] Inversor queimado/curto circuito interno" style="text-align:right; padding-right:10px;">[INV] Inversor queimado/curto circuito interno</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 41.8605%;" data-width="41.86046511627907%"></div></div>
                    <div class="bar-value">36 (7.02%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="[INV] Falha na MPPT" style="text-align:right; padding-right:10px;">[INV] Falha na MPPT</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 25.5814%;" data-width="25.581395348837212%"></div></div>
                    <div class="bar-value">22 (4.29%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="[INV] Falha isola√ß√£o CC" style="text-align:right; padding-right:10px;">[INV] Falha isola√ß√£o CC</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 19.7674%;" data-width="19.767441860465116%"></div></div>
                    <div class="bar-value">17 (3.31%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="[INV] Falha no circuito interno" style="text-align:right; padding-right:10px;">[INV] Falha no circuito interno</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 17.4419%;" data-width="17.441860465116278%"></div></div>
                    <div class="bar-value">15 (2.92%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="[MIC] Falha CC" style="text-align:right; padding-right:10px;">[MIC] Falha CC</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 16.2791%;" data-width="16.27906976744186%"></div></div>
                    <div class="bar-value">14 (2.73%)</div>
                </div></div>
        </section>

        <section class="chart-section">
            <div class="chart-title">3. Distribui√ß√£o Regional de RMAs</div>
            <div class="chart-subtitle">Clique no estado para filtrar os dados regionais</div>
            <div class="chart-container" id="chart-regions"><div class="bar-row ">
                    <div class="bar-label-main" title="GO" style="text-align:right; padding-right:10px;">GO</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 100%;" data-width="100%"></div></div>
                    <div class="bar-value">45 RMAs (11.54%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="ES" style="text-align:right; padding-right:10px;">ES</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 80%;" data-width="80%"></div></div>
                    <div class="bar-value">36 RMAs (9.23%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="RN" style="text-align:right; padding-right:10px;">RN</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 68.8889%;" data-width="68.88888888888889%"></div></div>
                    <div class="bar-value">31 RMAs (7.95%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="SP" style="text-align:right; padding-right:10px;">SP</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 66.6667%;" data-width="66.66666666666666%"></div></div>
                    <div class="bar-value">30 RMAs (7.69%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="MG" style="text-align:right; padding-right:10px;">MG</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 64.4444%;" data-width="64.44444444444444%"></div></div>
                    <div class="bar-value">29 RMAs (7.44%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="MT" style="text-align:right; padding-right:10px;">MT</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 51.1111%;" data-width="51.11111111111111%"></div></div>
                    <div class="bar-value">23 RMAs (5.90%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="RJ" style="text-align:right; padding-right:10px;">RJ</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 51.1111%;" data-width="51.11111111111111%"></div></div>
                    <div class="bar-value">23 RMAs (5.90%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="MS" style="text-align:right; padding-right:10px;">MS</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 51.1111%;" data-width="51.11111111111111%"></div></div>
                    <div class="bar-value">23 RMAs (5.90%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="PE" style="text-align:right; padding-right:10px;">PE</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 44.4444%;" data-width="44.44444444444444%"></div></div>
                    <div class="bar-value">20 RMAs (5.13%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="BA" style="text-align:right; padding-right:10px;">BA</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 37.7778%;" data-width="37.77777777777778%"></div></div>
                    <div class="bar-value">17 RMAs (4.36%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="CE" style="text-align:right; padding-right:10px;">CE</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 31.1111%;" data-width="31.11111111111111%"></div></div>
                    <div class="bar-value">14 RMAs (3.59%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="PA" style="text-align:right; padding-right:10px;">PA</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 28.8889%;" data-width="28.888888888888886%"></div></div>
                    <div class="bar-value">13 RMAs (3.33%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="SC" style="text-align:right; padding-right:10px;">SC</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 28.8889%;" data-width="28.888888888888886%"></div></div>
                    <div class="bar-value">13 RMAs (3.33%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="PR" style="text-align:right; padding-right:10px;">PR</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 28.8889%;" data-width="28.888888888888886%"></div></div>
                    <div class="bar-value">13 RMAs (3.33%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="MA" style="text-align:right; padding-right:10px;">MA</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 26.6667%;" data-width="26.666666666666668%"></div></div>
                    <div class="bar-value">12 RMAs (3.08%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="RS" style="text-align:right; padding-right:10px;">RS</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 22.2222%;" data-width="22.22222222222222%"></div></div>
                    <div class="bar-value">10 RMAs (2.56%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="TO" style="text-align:right; padding-right:10px;">TO</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 20%;" data-width="20%"></div></div>
                    <div class="bar-value">9 RMAs (2.31%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="PI" style="text-align:right; padding-right:10px;">PI</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 15.5556%;" data-width="15.555555555555555%"></div></div>
                    <div class="bar-value">7 RMAs (1.79%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="RO" style="text-align:right; padding-right:10px;">RO</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 15.5556%;" data-width="15.555555555555555%"></div></div>
                    <div class="bar-value">7 RMAs (1.79%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="PB" style="text-align:right; padding-right:10px;">PB</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 11.1111%;" data-width="11.11111111111111%"></div></div>
                    <div class="bar-value">5 RMAs (1.28%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="AL" style="text-align:right; padding-right:10px;">AL</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 8.88889%;" data-width="8.88888888888889%"></div></div>
                    <div class="bar-value">4 RMAs (1.03%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="DF" style="text-align:right; padding-right:10px;">DF</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 6.66667%;" data-width="6.666666666666667%"></div></div>
                    <div class="bar-value">3 RMAs (0.77%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="SE" style="text-align:right; padding-right:10px;">SE</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 4.44444%;" data-width="4.444444444444445%"></div></div>
                    <div class="bar-value">2 RMAs (0.51%)</div>
                </div><div class="bar-row ">
                    <div class="bar-label-main" title="RR" style="text-align:right; padding-right:10px;">RR</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 2.22222%;" data-width="2.2222222222222223%"></div></div>
                    <div class="bar-value">1 RMAs (0.26%)</div>
                </div></div>
        </section>

        <!-- NOVO GR√ÅFICO 4 -->
        <section class="chart-section">
            <div class="chart-title">4. Tempo M√©dio at√© Falha (MTTF Estimado)</div>
            <div class="chart-subtitle">Tempo decorrido entre a Venda e a abertura do RMA (M√©dia por Modelo)</div>
            <div class="chart-container" id="chart-mttf"><div class="empty-state">Sem dados dispon√≠veis.</div></div>
        </section>
    </main>
</div>

<script>
    // ==========================================
    // 1. CONFIGURA√á√ÉO E DADOS
    // ==========================================
    // Importante: EMBEDDED_DATA √© usado pelo exportador para salvar dados permanentes
    let EMBEDDED_DATA = {"vendasRMA":[{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW40K-LT-G3","rma":1,"sales":3,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW50K-LT-G2","rma":2,"sales":6,"dateSale":null,"dateRMA":null},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 4KTLM-G3","rma":2,"sales":6,"dateSale":null,"dateRMA":null},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 75KTLX-G3","rma":6,"sales":22,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC50K (10 ANOS DE GARANTIA)","rma":1,"sales":4,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW25K-LT-G2 PRO","rma":8,"sales":37,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW20K-UT-G3 220V","rma":3,"sales":17,"dateSale":null,"dateRMA":null},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 10KTLM-G3","rma":10,"sales":59,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW25K-UT-G3 220V","rma":1,"sales":6,"dateSale":null,"dateRMA":null},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 9KTLM-G3","rma":4,"sales":31,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW50K-LT-G3","rma":4,"sales":39,"dateSale":null,"dateRMA":null},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 5KTLM-G3","rma":3,"sales":48,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GR1P10K (10 ANOS DE GARANTIA)","rma":14,"sales":262,"dateSale":null,"dateRMA":null},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","rma":87,"sales":2113,"dateSale":null,"dateRMA":null},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 75KTLX-LV-G4","rma":2,"sales":53,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS SOLIS-75K-LV-5G-PRO (10 ANOS DE GARANTIA)","rma":1,"sales":39,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2","rma":30,"sales":1268,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS SOLIS-75K-5G-PRO (10 ANOS DE GARANTIA)","rma":3,"sales":132,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS SOLIS-50K-LV-5G-PRO (10 ANOS DE GARANTIA)","rma":1,"sales":56,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P3K-M (10 ANOS DE GARANTIA)","rma":13,"sales":767,"dateSale":null,"dateRMA":null},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-7.5SL C/ AFCI","rma":12,"sales":733,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","rma":16,"sales":1079,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","rma":15,"sales":1208,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC37.5K-LV  C/ AFCI","rma":1,"sales":98,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC37.5K C/ AFCI","rma":1,"sales":98,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S","rma":10,"sales":1125,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","rma":31,"sales":3704,"dateSale":null,"dateRMA":null},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI","rma":8,"sales":971,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW25K-LT-G2 PRO C/ AFCI","rma":3,"sales":401,"dateSale":null,"dateRMA":null},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","rma":98,"sales":13416,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)","rma":8,"sales":1180,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC25K-LV  C/ AFCI","rma":1,"sales":154,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GR3P20K  C/ AFCI","rma":1,"sales":162,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW15K-UT-G3 220V C/ AFCI","rma":3,"sales":501,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC15K-LV   C/ AFCI","rma":1,"sales":172,"dateSale":null,"dateRMA":null},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 6KTLM-G3 C/ AFCI","rma":2,"sales":344,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)","rma":9,"sales":1607,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW20K-LT-G2 PRO C/ AFCI","rma":3,"sales":644,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW37.5K-UT-G3 220V C/ AFCI","rma":1,"sales":218,"dateSale":null,"dateRMA":null},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-10SL C/ AFCI","rma":3,"sales":675,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW20K-UT-G3 220V C/ AFCI","rma":2,"sales":497,"dateSale":null,"dateRMA":null},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","rma":15,"sales":3834,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW7300-S C/ AFCI","rma":3,"sales":816,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S C/ AFCI","rma":3,"sales":871,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW33K-LT-G3 C/ AFCI","rma":1,"sales":318,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW17K-LT-G2 PRO C/ AFCI","rma":2,"sales":671,"dateSale":null,"dateRMA":null},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX3000D","rma":5,"sales":1745,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2","rma":7,"sales":2511,"dateSale":null,"dateRMA":null},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 5KTLM-G3 C/ AFCI","rma":1,"sales":362,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S C/ AFCI","rma":3,"sales":1148,"dateSale":null,"dateRMA":null},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 9KTLM-G3 C/ AFCI","rma":1,"sales":427,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P10K03 C/ AFCI","rma":3,"sales":1362,"dateSale":null,"dateRMA":null},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-6SL-G2 C/ AFCI","rma":2,"sales":1243,"dateSale":null,"dateRMA":null},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-3SL C/ AFCI","rma":1,"sales":629,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI","rma":9,"sales":5809,"dateSale":null,"dateRMA":null},{"manufacturer":"DEYE","product":"INVERSOR DEYE SUN-M225G4-EU-Q0-I 2250W","rma":4,"sales":2967,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2 C/AFCI","rma":1,"sales":947,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2 C/ AFCI","rma":5,"sales":4835,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S C/ AFCI","rma":1,"sales":1940,"dateSale":null,"dateRMA":null},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S C/ AFCI","rma":1,"sales":3137,"dateSale":null,"dateRMA":null}],"defeitos":[{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-10SL C/ AFCI","defect":"[INV] Inversor n√£o liga","count":3},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-3SL C/ AFCI","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-6SL-G2 C/ AFCI","defect":"[INV] Falha comunica√ß√£o","count":2},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-7.5SL C/ AFCI","defect":"[INV] Falha na MPPT","count":4},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-7.5SL C/ AFCI","defect":"[INV] Inversor queimado/curto circuito interno","count":3},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-7.5SL C/ AFCI","defect":"[INV] Falha instala√ß√£o/parte CC","count":2},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-7.5SL C/ AFCI","defect":"[INV] Inversor parou de funcionar","count":2},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-7.5SL C/ AFCI","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"DEYE","product":"INVERSOR DEYE SUN-M225G4-EU-Q0-I 2250W","defect":"[INV] Problema Conector CA","count":2},{"manufacturer":"DEYE","product":"INVERSOR DEYE SUN-M225G4-EU-Q0-I 2250W","defect":"[INV] Falha Interna","count":1},{"manufacturer":"DEYE","product":"INVERSOR DEYE SUN-M225G4-EU-Q0-I 2250W","defect":"[INV] Problema no conector CC","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 10KTLM-G3","defect":"[INV] Falha Interna","count":3},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 10KTLM-G3","defect":"[INV] Falha no circuito interno","count":2},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 10KTLM-G3","defect":"[INV] Falha de rel√©","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 10KTLM-G3","defect":"[INV] Falha isola√ß√£o CC","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 10KTLM-G3","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 10KTLM-G3","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 10KTLM-G3","defect":"[INV] Standby ou modo espera","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 250KTL-HV","defect":"[INV] Falha Interna","count":2},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 4KTLM-G3","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 4KTLM-G3","defect":"[INV] Problema Conector CA","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 5KTLM-G3","defect":"[INV] Falha Interna","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 5KTLM-G3","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 5KTLM-G3","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 5KTLM-G3 C/ AFCI","defect":"[INV] Standby ou modo espera","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 6KTLM-G3 C/ AFCI","defect":"[INV] Baixa gera√ß√£o","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 6KTLM-G3 C/ AFCI","defect":"[INV] Falha comunica√ß√£o","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI","defect":"[INV] Baixa gera√ß√£o","count":4},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI","defect":"[INV] Inversor Parou Funcionar","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI","defect":"[INV] Inversor queimado/curto circuito interno","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI","defect":"[INV] Problema Conector CA","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 75KTLX-G3","defect":"[INV] Atualiza√ß√£o de firmware","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 75KTLX-G3","defect":"[INV] Corrente residual alta","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 75KTLX-G3","defect":"[INV] Falha Interna","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 75KTLX-G3","defect":"[INV] Falha comunica√ß√£o","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 75KTLX-G3","defect":"[INV] Falha isola√ß√£o CC","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 75KTLX-G3","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 75KTLX-LV-G4","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 75KTLX-LV-G4","defect":"[INV] Problema Conector CA","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 9KTLM-G3","defect":"[INV] Falha isola√ß√£o CA","count":2},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 9KTLM-G3","defect":"[INV] Corrente de fuga alta","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 9KTLM-G3","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 9KTLM-G3 C/ AFCI","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC15K-LV   C/ AFCI","defect":"[INV] Atualiza√ß√£o de firmware","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC25K-LV  C/ AFCI","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC37.5K C/ AFCI","defect":"[INV] Falha Interna","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC37.5K-LV  C/ AFCI","defect":"[INV] Falha Interna","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC37.5K-LV (10 ANOS DE GARANTIA)","defect":"[INV] Falha Interna","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC37.5K-LV (10 ANOS DE GARANTIA)","defect":"[INV] Tens√£o anormal no barramento CC","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC50K (10 ANOS DE GARANTIA)","defect":"[INV] Falha Interna","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC60K (10 ANOS DE GARANTIA)","defect":"[INV] Falha Interna","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC60K (10 ANOS DE GARANTIA)","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC60K (10 ANOS DE GARANTIA)","defect":"[INV] Temperatura interna alta","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GR1P10K (10 ANOS DE GARANTIA)","defect":"[INV] Inversor n√£o liga","count":5},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GR1P10K (10 ANOS DE GARANTIA)","defect":"[INV] Inversor parou de funcionar","count":4},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GR1P10K (10 ANOS DE GARANTIA)","defect":"[INV] Disjuntor CA desarmando","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GR1P10K (10 ANOS DE GARANTIA)","defect":"[INV] Falha IFAN","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GR1P10K (10 ANOS DE GARANTIA)","defect":"[INV] Falha de rel√©","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GR1P10K (10 ANOS DE GARANTIA)","defect":"[INV] Falha no circuito interno","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GR1P10K (10 ANOS DE GARANTIA)","defect":"[INV] Problema Conector CA","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GR3P20K  C/ AFCI","defect":"[INV] Falha isola√ß√£o CC","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P10K03 C/ AFCI","defect":"[INV] Componente DC","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P10K03 C/ AFCI","defect":"[INV] Disjuntor CA desarmando","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P10K03 C/ AFCI","defect":"[INV] Standby ou modo espera","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P3K-M (10 ANOS DE GARANTIA)","defect":"[INV] Inversor parou de funcionar","count":5},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P3K-M (10 ANOS DE GARANTIA)","defect":"[INV] Inversor n√£o liga","count":3},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P3K-M (10 ANOS DE GARANTIA)","defect":"[INV] Falha Interna","count":2},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P3K-M (10 ANOS DE GARANTIA)","defect":"[INV] Falha isola√ß√£o CC","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P3K-M (10 ANOS DE GARANTIA)","defect":"[INV] Problema no Display","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P3K-M (10 ANOS DE GARANTIA)","defect":"[INV] Tens√£o da rede anormal","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)","defect":"[INV] Inversor parou de funcionar","count":4},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)","defect":"[INV] Inversor n√£o liga","count":2},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)","defect":"[INV] Falha na MPPT","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)","defect":"[INV] Problema no Display","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)","defect":"[INV] Tens√£o anormal no barramento CC","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S C/ AFCI","defect":"[INV] Baixa gera√ß√£o","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S C/ AFCI","defect":"[INV] Falha na MPPT","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S C/ AFCI","defect":"[INV] Problema no Display","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","defect":"[INV] Inversor parou de funcionar","count":5},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","defect":"[INV] Falha Interna","count":4},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","defect":"[INV] Falha isola√ß√£o CC","count":3},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","defect":"[INV] Inversor n√£o liga","count":2},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","defect":"[INV] Problema Conector CA","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","defect":"[INV] Standby ou modo espera","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S C/ AFCI","defect":"[INV] Falha Interna","count":2},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S C/ AFCI","defect":"[INV] Problema Conector CA","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)","defect":"[INV] Inversor parou de funcionar","count":3},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)","defect":"[INV] Inversor queimado/curto circuito interno","count":3},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)","defect":"[INV] Temperatura interna alta","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS SOLIS-50K-LV-5G-PRO (10 ANOS DE GARANTIA)","defect":"[INV] Falha no DPS","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS SOLIS-75K-5G-PRO (10 ANOS DE GARANTIA)","defect":"[INV] Falha IFAN","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS SOLIS-75K-5G-PRO (10 ANOS DE GARANTIA)","defect":"[INV] Falha na MPPT","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS SOLIS-75K-5G-PRO (10 ANOS DE GARANTIA)","defect":"[INV] PV reversed","count":1},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS SOLIS-75K-LV-5G-PRO (10 ANOS DE GARANTIA)","defect":"[INV] Falha EFAN","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","defect":"[INV] Inversor parou de funcionar","count":5},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","defect":"[INV] Falha de rel√©","count":3},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","defect":"[INV] Tens√£o da rede anormal","count":3},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","defect":"[INV] Falha Interna","count":2},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","defect":"[INV] Falha isola√ß√£o CC","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S C/ AFCI","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW15K-LT-G2 PRO","defect":"[INV] Inversor parou de funcionar","count":3},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW15K-LT-G2 PRO","defect":"[INV] Baixa gera√ß√£o","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW15K-LT-G2 PRO","defect":"[INV] Falha Interna","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW15K-LT-G2 PRO","defect":"[INV] Inversor queimado/curto circuito interno","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW15K-LT-G2 PRO","defect":"[MOD] Hotspot","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW15K-UT-G3 220V C/ AFCI","defect":"[INV] Inversor parou de funcionar","count":3},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW17K-LT-G2 PRO","defect":"[INV] Inversor parou de funcionar","count":2},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW17K-LT-G2 PRO","defect":"[INV] Falha Interna","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW17K-LT-G2 PRO C/ AFCI","defect":"[INV] Falha de rel√©","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW17K-LT-G2 PRO C/ AFCI","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW20K-LT-G2 PRO C/ AFCI","defect":"[INV] Falha Interna","count":2},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW20K-LT-G2 PRO C/ AFCI","defect":"[INV] Falha isola√ß√£o CA","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW20K-UT-G3 220V","defect":"[INV] Falha IFAN","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW20K-UT-G3 220V","defect":"[INV] Falha de rel√©","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW20K-UT-G3 220V","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW20K-UT-G3 220V C/ AFCI","defect":"[INV] Inversor parou de funcionar","count":2},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW25K-LT-G2 PRO","defect":"[INV] Inversor parou de funcionar","count":5},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW25K-LT-G2 PRO","defect":"[INV] Falha Interna","count":2},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW25K-LT-G2 PRO","defect":"[INV] Inversor queimado/curto circuito interno","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW25K-LT-G2 PRO C/ AFCI","defect":"[INV] Falha no circuito interno","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW25K-LT-G2 PRO C/ AFCI","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW25K-LT-G2 PRO C/ AFCI","defect":"[INV] Tens√£o anormal no barramento CC","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW25K-UT-G3 220V","defect":"[INV] Tens√£o anormal no barramento CC","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2","defect":"[INV] Falha Interna","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2","defect":"[INV] Falha isola√ß√£o CC","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2","defect":"[INV] Falha na MPPT","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2","defect":"[INV] Falha no circuito interno","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2","defect":"[INV] Problema Conector CA","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2","defect":"[INV] Tens√£o CA fora da faixa","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2 C/AFCI","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW33K-LT-G3 C/ AFCI","defect":"[INV] Falha isola√ß√£o CA","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW37.5K-UT-G3 220V","defect":"[INV] Falha Interna","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW37.5K-UT-G3 220V","defect":"[INV] Inversor Parou Funcionar","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW37.5K-UT-G3 220V","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW37.5K-UT-G3 220V C/ AFCI","defect":"[INV] Falha comunica√ß√£o","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW40K-LT-G3","defect":"[INV] Standby ou modo espera","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2","defect":"[INV] Inversor parou de funcionar","count":7},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2","defect":"[INV] Falha de rel√©","count":6},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2","defect":"[INV] Inversor n√£o liga","count":6},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2","defect":"[INV] Falha Interna","count":5},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2","defect":"[INV] Falha isola√ß√£o CA","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2","defect":"[INV] Falha na MPPT","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2","defect":"[INV] Inversor Parou Funcionar","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2","defect":"[INV] Inversor queimado/curto circuito interno","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2","defect":"[INV] Tens√£o CA fora da faixa","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2","defect":"[INV] Tens√£o da rede anormal","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI","defect":"[INV] Falha de rel√©","count":2},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI","defect":"[INV] Falha no circuito interno","count":2},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI","defect":"[INV] Inversor parou de funcionar","count":2},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI","defect":"[INV] Falha Interna","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI","defect":"[INV] Falha na MPPT","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW50K-LT-G2","defect":"[INV] Falha Interna","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW50K-LT-G2","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW50K-LT-G3","defect":"[INV] Inversor parou de funcionar","count":3},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW50K-LT-G3","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","defect":"[INV] Falha de rel√©","count":13},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","defect":"[INV] Falha Interna","count":7},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","defect":"[INV] Inversor parou de funcionar","count":5},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","defect":"[INV] Falha na MPPT","count":3},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","defect":"[INV] Falha isola√ß√£o CC","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","defect":"[INV] Tens√£o CA fora da faixa","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2 C/ AFCI","defect":"[INV] Inversor parou de funcionar","count":2},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2 C/ AFCI","defect":"[INV] Falha Interna","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2 C/ AFCI","defect":"[INV] Falha na MPPT","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2 C/ AFCI","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW7300-S C/ AFCI","defect":"[INV] Falha isola√ß√£o CC","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW7300-S C/ AFCI","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW7300-S C/ AFCI","defect":"[INV] Inversor queimado/curto circuito interno","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S","defect":"[INV] Inversor parou de funcionar","count":3},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S","defect":"[INV] Falha de rel√©","count":2},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S","defect":"[INV] Falha Interna","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S","defect":"[INV] Falha isola√ß√£o CC","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S","defect":"[INV] Problema Conector CA","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S","defect":"[INV] Temperatura interna alta","count":1},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S C/ AFCI","defect":"[INV] Disjuntor CA desarmando","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[INV] Falha Interna","count":21},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[INV] Inversor queimado/curto circuito interno","count":10},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[MIC] Falha Ponte H","count":9},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[INV] Falha de rel√©","count":7},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[INV] Atualiza√ß√£o de firmware","count":5},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[INV] Falha isola√ß√£o CC","count":5},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[INV] Falha comunica√ß√£o","count":4},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[INV] Inversor parou de funcionar","count":4},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[INV] Temperatura interna alta","count":4},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[MIC] Falha CA","count":3},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[MIC] Falha De Conex√£o Wifi","count":3},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[INV] Falha no circuito interno","count":2},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[INV] Inversor Parou Funcionar","count":2},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[INV] Inversor n√£o liga","count":2},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[INV] Baixa gera√ß√£o","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[INV] Falha de software","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[INV] Falha isola√ß√£o CA","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[INV] Falha na MPPT","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[MIC] Falha CC","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","defect":"[MIC] Falha VGOFFSET","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","defect":"[INV] Falha na MPPT","count":3},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","defect":"[INV] Inversor queimado/curto circuito interno","count":3},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","defect":"[INV] Falha Interna","count":2},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","defect":"[INV] Falha no circuito interno","count":2},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","defect":"[MIC] Falha Ponte H","count":2},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","defect":"[MIC] Falha CC","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","defect":"[MIC] Falha De Conex√£o Wifi","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","defect":"[MIC] Falha Ponte H","count":46},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","defect":"[INV] Inversor queimado/curto circuito interno","count":12},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","defect":"[MIC] Falha CC","count":10},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","defect":"[INV] Falha Interna","count":5},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","defect":"[INV] Falha na MPPT","count":4},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","defect":"[INV] Falha no circuito interno","count":4},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","defect":"[MIC] Falha De Conex√£o Wifi","count":4},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","defect":"[INV] Problema Conector CA","count":3},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","defect":"[MIC] Falha CA","count":3},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","defect":"[INV] Temperatura interna alta","count":2},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","defect":"[INV] Disjuntor CA Desarmando","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","defect":"[INV] Falha comunica√ß√£o","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","defect":"[INV] Inversor n√£o liga","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","defect":"[INV] Inversor parou de funcionar","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","defect":"[MIC] Falha De Conex√£o CA","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX3000D","defect":"[MIC] Falha CC","count":2},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX3000D","defect":"[INV] Problema no conector CC","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX3000D","defect":"[MIC] Falha CA","count":1},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX3000D","defect":"[MIC] Falha De Conex√£o Wifi","count":1}],"regional":[{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-6SL-G2 C/ AFCI","state":"BA","rma":1,"sales":67},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-7.5SL C/ AFCI","state":"BA","rma":1,"sales":27},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-6SL-G2 C/ AFCI","state":"GO","rma":1,"sales":90},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-10SL C/ AFCI","state":"MA","rma":2,"sales":32},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-3SL C/ AFCI","state":"MT","rma":1,"sales":29},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-10SL C/ AFCI","state":"PA","rma":1,"sales":75},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-7.5SL C/ AFCI","state":"PE","rma":1,"sales":29},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-7.5SL C/ AFCI","state":"PI","rma":1,"sales":19},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-7.5SL C/ AFCI","state":"RN","rma":5,"sales":70},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-7.5SL C/ AFCI","state":"RS","rma":1,"sales":20},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-7.5SL C/ AFCI","state":"SP","rma":2,"sales":29},{"manufacturer":"AUXSOL","product":"INVERSOR AUXSOL ASN-7.5SL C/ AFCI","state":"TO","rma":1,"sales":26},{"manufacturer":"DEYE","product":"INVERSOR DEYE SUN-M225G4-EU-Q0-I 2250W","state":"DF","rma":2,"sales":71},{"manufacturer":"DEYE","product":"INVERSOR DEYE SUN-M225G4-EU-Q0-I 2250W","state":"SC","rma":1,"sales":177},{"manufacturer":"DEYE","product":"INVERSOR DEYE SUN-M225G4-EU-Q0-I 2250W","state":"SE","rma":1,"sales":92},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI","state":"ES","rma":2,"sales":59},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 9KTLM-G3 C/ AFCI","state":"GO","rma":1,"sales":30},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI","state":"MT","rma":1,"sales":118},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 75KTLX-LV-G4","state":"MT","rma":1,"sales":8},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 9KTLM-G3","state":"MT","rma":1,"sales":2},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 75KTLX-LV-G4","state":"PA","rma":1,"sales":8},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI","state":"RJ","rma":1,"sales":24},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI","state":"RN","rma":1,"sales":77},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 7.5KTLM-G3-BR C/ AFCI","state":"RO","rma":3,"sales":20},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 5KTLM-G3 C/ AFCI","state":"SC","rma":1,"sales":26},{"manufacturer":"SOFAR","product":"INVERSOR SOFAR 9KTLM-G3","state":"SP","rma":1,"sales":4},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)","state":"BA","rma":2,"sales":115},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","state":"BA","rma":1,"sales":91},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GR3P20K  C/ AFCI","state":"CE","rma":1,"sales":7},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)","state":"CE","rma":1,"sales":83},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S C/ AFCI","state":"CE","rma":1,"sales":23},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)","state":"CE","rma":1,"sales":33},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P10K03 C/ AFCI","state":"ES","rma":1,"sales":307},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)","state":"ES","rma":1,"sales":120},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","state":"ES","rma":4,"sales":73},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)","state":"ES","rma":2,"sales":107},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS SOLIS-50K-LV-5G-PRO (10 ANOS DE GARANTIA)","state":"ES","rma":1,"sales":2},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC37.5K C/ AFCI","state":"GO","rma":1,"sales":20},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S C/ AFCI","state":"GO","rma":1,"sales":78},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","state":"GO","rma":3,"sales":93},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)","state":"GO","rma":1,"sales":78},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S C/ AFCI","state":"MG","rma":1,"sales":72},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","state":"MS","rma":2,"sales":45},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P10K03 C/ AFCI","state":"MT","rma":1,"sales":86},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)","state":"MT","rma":2,"sales":107},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S C/ AFCI","state":"MT","rma":1,"sales":57},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","state":"MT","rma":1,"sales":197},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)","state":"MT","rma":1,"sales":120},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S C/ AFCI","state":"PA","rma":1,"sales":90},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)","state":"PA","rma":1,"sales":151},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P10K03 C/ AFCI","state":"PE","rma":1,"sales":38},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)","state":"PE","rma":2,"sales":120},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC15K-LV   C/ AFCI","state":"PR","rma":1,"sales":24},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC25K-LV  C/ AFCI","state":"PR","rma":1,"sales":23},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","state":"PR","rma":1,"sales":18},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S C/ AFCI","state":"PR","rma":1,"sales":69},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S5-GC37.5K-LV  C/ AFCI","state":"RJ","rma":1,"sales":15},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","state":"RJ","rma":1,"sales":25},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P5K-S (10 ANOS DE GARANTIA)","state":"RN","rma":1,"sales":153},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P8K2 (10 ANOS DE GARANTIA)","state":"RN","rma":2,"sales":89},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","state":"RO","rma":2,"sales":20},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS S6-GR1P6K-S (10 ANOS DE GARANTIA)","state":"RS","rma":1,"sales":18},{"manufacturer":"SOLIS","product":"INVERSOR SOLIS SOLIS-75K-LV-5G-PRO (10 ANOS DE GARANTIA)","state":"SP","rma":1,"sales":8},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2 C/AFCI","state":"AL","rma":1,"sales":48},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","state":"AL","rma":1,"sales":69},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","state":"BA","rma":1,"sales":26},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW25K-LT-G2 PRO","state":"BA","rma":2,"sales":19},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","state":"BA","rma":2,"sales":237},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S","state":"BA","rma":1,"sales":52},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW20K-LT-G2 PRO C/ AFCI","state":"CE","rma":1,"sales":106},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2","state":"CE","rma":2,"sales":145},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW33K-LT-G3 C/ AFCI","state":"CE","rma":1,"sales":109},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI","state":"CE","rma":1,"sales":439},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","state":"CE","rma":1,"sales":119},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","state":"DF","rma":1,"sales":12},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","state":"ES","rma":1,"sales":73},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW15K-UT-G3 220V C/ AFCI","state":"ES","rma":2,"sales":66},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW20K-UT-G3 220V C/ AFCI","state":"ES","rma":1,"sales":88},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI","state":"ES","rma":2,"sales":223},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","state":"ES","rma":4,"sales":301},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW7300-S C/ AFCI","state":"ES","rma":1,"sales":181},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S","state":"ES","rma":2,"sales":58},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW25K-LT-G2 PRO C/ AFCI","state":"GO","rma":1,"sales":42},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","state":"GO","rma":3,"sales":185},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2 C/ AFCI","state":"GO","rma":1,"sales":175},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","state":"MA","rma":1,"sales":22},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2","state":"MA","rma":1,"sales":59},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","state":"MA","rma":1,"sales":103},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2 C/ AFCI","state":"MA","rma":1,"sales":159},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S","state":"MA","rma":3,"sales":13},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","state":"MG","rma":2,"sales":53},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW25K-UT-G3 220V","state":"MG","rma":1,"sales":2},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI","state":"MG","rma":1,"sales":256},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW7300-S C/ AFCI","state":"MG","rma":1,"sales":155},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S","state":"MG","rma":1,"sales":8},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2","state":"MS","rma":1,"sales":70},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","state":"MS","rma":1,"sales":127},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","state":"MT","rma":1,"sales":184},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW20K-UT-G3 220V C/ AFCI","state":"MT","rma":1,"sales":35},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","state":"MT","rma":5,"sales":600},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S","state":"MT","rma":1,"sales":222},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","state":"PA","rma":1,"sales":169},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S C/ AFCI","state":"PA","rma":1,"sales":531},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","state":"PA","rma":1,"sales":410},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2 C/ AFCI","state":"PA","rma":2,"sales":720},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","state":"PB","rma":1,"sales":18},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2 C/ AFCI","state":"PB","rma":1,"sales":148},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW7300-S C/ AFCI","state":"PB","rma":1,"sales":7},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S C/ AFCI","state":"PB","rma":1,"sales":59},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW17K-LT-G2 PRO C/ AFCI","state":"PE","rma":2,"sales":115},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW20K-LT-G2 PRO C/ AFCI","state":"PE","rma":1,"sales":119},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW25K-LT-G2 PRO","state":"PE","rma":2,"sales":4},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","state":"PE","rma":2,"sales":243},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW25K-LT-G2 PRO C/ AFCI","state":"PI","rma":2,"sales":24},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2","state":"PI","rma":1,"sales":96},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","state":"PI","rma":2,"sales":104},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S","state":"PI","rma":1,"sales":17},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","state":"PR","rma":2,"sales":76},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","state":"RJ","rma":1,"sales":15},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI","state":"RJ","rma":2,"sales":308},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","state":"RJ","rma":1,"sales":168},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW3000-S-G2","state":"RN","rma":2,"sales":330},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","state":"RN","rma":4,"sales":346},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW8000-S","state":"RN","rma":1,"sales":38},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","state":"RO","rma":1,"sales":48},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW15K-UT-G3 220V C/ AFCI","state":"RR","rma":1,"sales":6},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI","state":"SC","rma":2,"sales":297},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW6000-S-G2","state":"SE","rma":1,"sales":54},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW37.5K-UT-G3 220V C/ AFCI","state":"SP","rma":1,"sales":6},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW5000-S-G2 C/ AFCI","state":"SP","rma":1,"sales":291},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW10000-S","state":"TO","rma":4,"sales":44},{"manufacturer":"SOLPLANET","product":"INVERSOR SOLPLANET ASW20K-LT-G2 PRO C/ AFCI","state":"TO","rma":1,"sales":20},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"AL","rma":1,"sales":49},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"BA","rma":4,"sales":80},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"CE","rma":2,"sales":82},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"ES","rma":3,"sales":54},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"GO","rma":9,"sales":219},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"MA","rma":2,"sales":15},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"MG","rma":10,"sales":219},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"MS","rma":15,"sales":330},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"MT","rma":3,"sales":85},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"PA","rma":1,"sales":79},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"PE","rma":2,"sales":101},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"PR","rma":2,"sales":32},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"RJ","rma":11,"sales":125},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"RN","rma":9,"sales":118},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"RS","rma":2,"sales":61},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"SC","rma":2,"sales":123},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"SP","rma":6,"sales":186},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MP3000","state":"TO","rma":2,"sales":34},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","state":"AL","rma":1,"sales":98},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","state":"ES","rma":2,"sales":238},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","state":"MG","rma":1,"sales":371},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","state":"MT","rma":1,"sales":117},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","state":"PA","rma":1,"sales":181},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","state":"PE","rma":1,"sales":227},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","state":"PR","rma":2,"sales":162},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","state":"RJ","rma":1,"sales":449},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","state":"RN","rma":3,"sales":260},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MS2000 (0.5M)","state":"SP","rma":2,"sales":296},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"BA","rma":2,"sales":547},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"CE","rma":1,"sales":435},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"ES","rma":7,"sales":1076},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"GO","rma":21,"sales":1317},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"MA","rma":1,"sales":212},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"MG","rma":10,"sales":1783},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"MS","rma":3,"sales":294},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"MT","rma":1,"sales":709},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"PA","rma":2,"sales":447},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"PB","rma":1,"sales":69},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"PE","rma":6,"sales":873},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"PR","rma":3,"sales":634},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"RJ","rma":4,"sales":1332},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"RN","rma":3,"sales":671},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"RO","rma":1,"sales":31},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"RS","rma":6,"sales":197},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"SC","rma":7,"sales":603},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"SP","rma":16,"sales":1031},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX2250","state":"TO","rma":1,"sales":174},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX3000D","state":"CE","rma":1,"sales":32},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX3000D","state":"GO","rma":2,"sales":260},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX3000D","state":"MG","rma":1,"sales":208},{"manufacturer":"TSUNESS","product":"INVERSOR TSUNESS TSOL-MX3000D","state":"MS","rma":1,"sales":106}]}; 

    let DB = {
        vendasRMA: [],
        defeitos: [],
        regional: []
    };

    const state = {
        filters: { manufacturers: [], models: [] },
        dateRange: { start: null, end: null }, 
        activeSelection: { type: null, value: null }, 
        loadedFromStorage: false
    };

    const STORAGE_KEY = 'rma_dashboard_data_v29'; 

    // ==========================================
    // 2. FUN√á√ïES DE FILTRO INTERATIVO
    // ==========================================

    function handleChartClick(type, value) {
        if (state.activeSelection.type === type && state.activeSelection.value === value) {
            clearActiveSelection();
        } else {
            state.activeSelection = { type, value };
            renderActiveFilters();
            updateDashboard();
        }
    }

    function clearActiveSelection() {
        state.activeSelection = { type: null, value: null };
        renderActiveFilters();
        updateDashboard();
    }

    function handleDateChange() {
        const startInput = document.getElementById('start-date').value;
        const endInput = document.getElementById('end-date').value;
        
        state.dateRange.start = startInput ? new Date(startInput) : null;
        state.dateRange.end = endInput ? new Date(endInput) : null;
        
        updateDashboard();
    }

    function renderActiveFilters() {
        const container = document.getElementById('active-filters-container');
        container.innerHTML = '';
        
        if (state.activeSelection.type) {
            const typeLabels = { 'state': 'Estado', 'model': 'Modelo', 'defect': 'Defeito' };
            const div = document.createElement('div');
            div.className = 'active-filter-chip';
            div.innerHTML = `
                ${typeLabels[state.activeSelection.type]}: ${state.activeSelection.value}
                <button onclick="clearActiveSelection()" title="Remover filtro">√ó</button>
            `;
            container.appendChild(div);
        }
    }

    // ==========================================
    // 3. PROCESSAMENTO DE DADOS (ROBUSTO)
    // ==========================================

    function filterData() {
        const manuf = state.filters?.manufacturers || []; 
        const mods = state.filters?.models || []; 
        const { dateRange } = state; 
        const { type: selType, value: selValue } = state.activeSelection;

        let filteredVendas = DB.vendasRMA.filter(row => {
            if (!manuf.includes(row.manufacturer) || !mods.includes(row.product)) return false;
            if (dateRange.start || dateRange.end) {
                if (!row.dateRMA) return false; 
                const rmaTime = new Date(row.dateRMA).getTime();
                if (dateRange.start && rmaTime < dateRange.start.getTime()) return false;
                if (dateRange.end && rmaTime > dateRange.end.getTime()) return false;
            }
            return true;
        });

        let filteredDefeitos = DB.defeitos.filter(row => manuf.includes(row.manufacturer) && mods.includes(row.product));
        let filteredRegional = DB.regional.filter(row => manuf.includes(row.manufacturer) && mods.includes(row.product));

        if (dateRange.start || dateRange.end) {
            const activeModels = [...new Set(filteredVendas.map(v => v.product))];
            filteredDefeitos = filteredDefeitos.filter(d => activeModels.includes(d.product));
            filteredRegional = filteredRegional.filter(r => activeModels.includes(r.product));
        }

        if (selType === 'state') {
            filteredRegional = filteredRegional.filter(r => r.state === selValue);
            const productsInState = [...new Set(filteredRegional.map(r => r.product))];
            
            const vendasSimuladas = [];
            filteredRegional.forEach(r => {
                vendasSimuladas.push({
                    manufacturer: r.manufacturer,
                    product: r.product,
                    rma: r.rma,
                    sales: r.sales || 0,
                    dateSale: r.dateSale,
                    dateRMA: r.dateRMA
                });
            });
            filteredVendas = vendasSimuladas;
            filteredDefeitos = filteredDefeitos.filter(d => productsInState.includes(d.product));

        } else if (selType === 'model') {
            filteredVendas = filteredVendas.filter(v => v.product === selValue);
            filteredDefeitos = filteredDefeitos.filter(d => d.product === selValue);
            filteredRegional = filteredRegional.filter(r => r.product === selValue);
        
        } else if (selType === 'defect') {
            filteredDefeitos = filteredDefeitos.filter(d => d.defect === selValue);
            const affectedModels = [...new Set(filteredDefeitos.map(d => d.product))];
            filteredVendas = filteredVendas.filter(v => affectedModels.includes(v.product));
            filteredRegional = filteredRegional.filter(r => affectedModels.includes(r.product));
        }

        return { vendas: filteredVendas, defeitos: filteredDefeitos, regional: filteredRegional };
    }

    // ==========================================
    // 4. ATUALIZA√á√ÉO DO DASHBOARD
    // ==========================================

    function updateDashboard() {
        const data = filterData();
        updateKPIs(data);
        updateCharts(data);
        updateInsights(data);
        
        const hasData = DB.vendasRMA.length > 0 || DB.regional.length > 0;
        if (hasData) {
            document.getElementById('last-update').innerText = "Dados carregados";
            document.getElementById('export-btn').style.display = "block";
        } else {
            document.getElementById('last-update').innerText = "Aguardando dados";
            document.getElementById('export-btn').style.display = "none";
        }
    }

    function updateKPIs(data) {
        const totalRMA = data.vendas.reduce((sum, item) => sum + item.rma, 0);
        const totalSales = data.vendas.reduce((sum, item) => sum + (item.sales || 0), 0);
        const rate = totalSales > 0 ? (totalRMA / totalSales) * 100 : 0;
        const uniqueStates = new Set(data.regional.map(r => r.state));

        animateValue('kpi-total-rma', totalRMA);
        animateValue('kpi-total-sales', totalSales);
        document.getElementById('kpi-rate').innerText = rate.toFixed(2) + "%";
        document.getElementById('kpi-states').innerText = uniqueStates.size;
    }

    function animateValue(id, end) {
        const obj = document.getElementById(id);
        if(!obj) return;
        const current = parseInt(obj.innerText.replace(/\D/g,'')) || 0;
        if(current === end) return;
        obj.innerText = end.toLocaleString('pt-BR');
    }

    function updateCharts(data) {
        // Chart 1: Modelos (Taxa %)
        const modelMap = {};
        data.vendas.forEach(item => {
            if(!modelMap[item.product]) {
                modelMap[item.product] = { 
                    label: item.product, 
                    subLabel: item.manufacturer, 
                    rma: 0, 
                    sales: 0 
                };
            }
            modelMap[item.product].rma += item.rma;
            modelMap[item.product].sales += (item.sales || 0);
        });

        const sortedModels = Object.values(modelMap)
            .map(item => ({ ...item, rate: item.sales > 0 ? (item.rma / item.sales * 100) : 0 }))
            .sort((a, b) => b.rate - a.rate);

        renderBarChart('chart-models', sortedModels.map(item => ({
            id: item.label,
            type: 'model',
            label: item.label,
            subLabel: item.subLabel,
            value: item.rate,
            displayValue: `${item.rate.toFixed(2)}% (${item.rma} RMAs)`,
            salesValue: `Vendas: ${item.sales.toLocaleString('pt-BR')}`
        })), true);

        // Chart 2: Defeitos
        const defectMap = {};
        data.defeitos.forEach(d => defectMap[d.defect] = (defectMap[d.defect] || 0) + d.count);
        const totalDefectsCount = Object.values(defectMap).reduce((a,b)=>a+b, 0);
        const sortedDefects = Object.keys(defectMap)
            .map(key => ({ name: key, count: defectMap[key] }))
            .sort((a, b) => b.count - a.count)
            .slice(0, 10);

        renderBarChart('chart-defects', sortedDefects.map(item => ({ 
            id: item.name,
            type: 'defect',
            label: item.name, 
            value: item.count, 
            displayValue: `${item.count} (${totalDefectsCount > 0 ? (item.count/totalDefectsCount*100).toFixed(2) : 0}%)` 
        })));

        // Chart 3: Regional
        const stateMap = {};
        data.regional.forEach(r => stateMap[r.state] = (stateMap[r.state] || 0) + r.rma);
        const totalRegionalFiltered = Object.values(stateMap).reduce((a, b) => a + b, 0);
        const sortedStates = Object.keys(stateMap)
            .map(key => ({ name: key, count: stateMap[key] }))
            .sort((a, b) => b.count - a.count);

        renderBarChart('chart-regions', sortedStates.map(item => ({ 
            id: item.name,
            type: 'state',
            label: item.name, 
            value: item.count, 
            displayValue: `${item.count} RMAs (${totalRegionalFiltered > 0 ? (item.count/totalRegionalFiltered*100).toFixed(2) : 0}%)` 
        })));

        // Chart 4: MTTF
        const timeMap = {};
        data.vendas.forEach(item => {
            if (item.dateSale && item.dateRMA) {
                const start = new Date(item.dateSale);
                const end = new Date(item.dateRMA);
                if (!isNaN(start) && !isNaN(end) && end >= start) {
                    const diffTime = Math.abs(end - start);
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
                    if(!timeMap[item.product]) {
                        timeMap[item.product] = { totalDays: 0, count: 0, label: item.product, subLabel: item.manufacturer };
                    }
                    timeMap[item.product].totalDays += diffDays;
                    timeMap[item.product].count += 1;
                }
            }
        });
        const timeModels = Object.values(timeMap)
            .map(item => ({ ...item, avgDays: Math.round(item.totalDays / item.count) }))
            .sort((a, b) => a.avgDays - b.avgDays);

        const formatDuration = (days) => {
            if (days < 0) return "0 dias";
            const years = Math.floor(days / 365);
            const remainderYear = days % 365;
            const months = Math.floor(remainderYear / 30);
            const remainingDays = remainderYear % 30;
            let parts = [];
            if (years > 0) parts.push(`${years} ano${years > 1 ? 's' : ''}`);
            if (months > 0) parts.push(`${months} m${months > 1 ? 'eses' : '√™s'}`);
            if (remainingDays > 0) parts.push(`${remainingDays} dia${remainingDays > 1 ? 's' : ''}`);
            return parts.length > 0 ? parts.join(', ') : "0 dias";
        };

        renderBarChart('chart-mttf', timeModels.map(item => ({
            id: item.label,
            type: 'model',
            label: item.label,
            subLabel: item.subLabel,
            value: item.avgDays,
            displayValue: formatDuration(item.avgDays),
            salesValue: `Amostra: ${item.count} un.`
        })), true);
    }

    function renderBarChart(containerId, data, detailed = false) {
        const container = document.getElementById(containerId);
        container.innerHTML = '';
        if (data.length === 0) {
            container.innerHTML = '<div class="empty-state">Sem dados dispon√≠veis.</div>';
            return;
        }
        const maxValue = Math.max(...data.map(d => d.value));
        
        data.forEach(item => {
            const widthPercent = maxValue > 0 ? (item.value / maxValue * 100) : 0;
            const row = document.createElement('div');
            const isSelected = state.activeSelection.type === item.type && state.activeSelection.value === item.id;
            row.className = `bar-row ${isSelected ? 'selected' : ''}`;
            row.onclick = () => handleChartClick(item.type, item.id);
            
            if (detailed) {
                row.innerHTML = `
                    <div class="bar-label-group">
                        <div class="bar-label-main" title="${item.label}">${item.label}</div>
                        <div class="bar-label-sub">${item.subLabel || ''}</div>
                    </div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0%" data-width="${widthPercent}%"></div></div>
                    <div>
                        <div class="bar-value">${item.displayValue}</div>
                        <div class="bar-value-sub">${item.salesValue || ''}</div>
                    </div>
                `;
            } else {
                const labelText = item.label.length > 50 ? item.label.substring(0, 47) + '...' : item.label;
                row.innerHTML = `
                    <div class="bar-label-main" title="${item.label}" style="text-align:right; padding-right:10px;">${labelText}</div>
                    <div class="bar-track"><div class="bar-fill" style="width: 0%" data-width="${widthPercent}%"></div></div>
                    <div class="bar-value">${item.displayValue}</div>
                `;
            }
            container.appendChild(row);
        });
        setTimeout(() => {
            container.querySelectorAll('.bar-fill').forEach(fill => fill.style.width = fill.getAttribute('data-width'));
        }, 50);
    }

    // ==========================================
    // 5. INSIGHTS
    // ==========================================

    function updateInsights(data) {
        const container = document.getElementById('insights-content');
        const { type, value } = state.activeSelection;
        
        const getTop = (arr, keyFn, valFn) => {
            const map = {};
            arr.forEach(item => {
                const k = keyFn(item);
                const v = valFn ? valFn(item) : (item.count || item.rma || 0);
                map[k] = (map[k] || 0) + v;
            });
            const sorted = Object.entries(map).sort((a,b) => b[1] - a[1]);
            return sorted.length > 0 ? { name: sorted[0][0], value: sorted[0][1] } : null;
        };

        const aggregateModels = (vendasList) => {
            const modelAgg = {};
            vendasList.forEach(v => {
                if(!modelAgg[v.product]) modelAgg[v.product] = { rma: 0, sales: 0 };
                modelAgg[v.product].rma += v.rma;
                modelAgg[v.product].sales += (v.sales || 0);
            });
            return Object.entries(modelAgg).map(([prod, stats]) => ({ product: prod, ...stats }));
        };

        const aggregatedVendas = aggregateModels(data.vendas);

        let html = '';

        if (data.vendas.length === 0) {
            container.innerHTML = "Carregue seus dados ou ajuste os filtros."; 
            return; 
        }

        const highestVol = [...aggregatedVendas].sort((a,b) => b.rma - a.rma)[0];
        if (highestVol) {
             let volText = `O modelo com maior volume absoluto √© <strong>${highestVol.product}</strong> (${highestVol.rma} casos).`;
             if (type === 'state') {
                 volText = `Em <strong>${value}</strong>, o maior volume de chamados √© do <strong>${highestVol.product}</strong> (${highestVol.rma} casos).`;
             } else if (type === 'defect') {
                 volText = `O modelo mais impactado por este defeito √© <strong>${highestVol.product}</strong> (${highestVol.rma} casos).`;
             }
             html += `<div class="insight-item">üìä ${volText}</div>`;
        }

        const worstRateModel = [...aggregatedVendas]
            .filter(i => i.sales > 3)
            .sort((a, b) => (b.rma/b.sales) - (a.rma/a.sales))[0];
        
        if (worstRateModel) {
            const rate = ((worstRateModel.rma / worstRateModel.sales) * 100).toFixed(2);
            let modelText = `A maior taxa de falha (vendas > 3) √© do <strong>${worstRateModel.product}</strong> (${rate}%).`;
            
            if (type === 'state') {
                modelText = `Em <strong>${value}</strong>, a maior taxa de falha √© do <strong>${worstRateModel.product}</strong> (${rate}%).`;
            }
            html += `<div class="insight-item">üö® ${modelText}</div>`;
        }

        const topDefect = getTop(data.defeitos, d => d.defect, d => d.count);
        if (topDefect) {
            let defectText = `O defeito mais comum √© <strong>${topDefect.name}</strong> (${topDefect.value} casos).`;
            if (type === 'model') {
                defectText = `Para este modelo, o problema principal √© <strong>${topDefect.name}</strong>.`;
            } else if (type === 'state') {
                defectText = `O defeito predominante em <strong>${value}</strong> √© <strong>${topDefect.name}</strong>.`;
            }
            html += `<div class="insight-item">üîß ${defectText}</div>`;
        }

        if (type === 'state') {
             const totalStateRMA = data.regional.reduce((acc, r) => acc + r.rma, 0);
             html += `<div class="insight-item">üìç <strong>${value}</strong> concentra um total de <strong>${totalStateRMA}</strong> RMAs registrados.</div>`;
        } else if (type === 'model') {
            const topStateForModel = getTop(data.regional, r => r.state, r => r.rma);
            if(topStateForModel) {
                html += `<div class="insight-item">üìç A regi√£o mais afetada por este modelo √© <strong>${topStateForModel.name}</strong> (${topStateForModel.value} casos).</div>`;
            }
        } else {
            const topState = getTop(data.regional, r => r.state, r => r.rma);
            if (topState) {
                html += `<div class="insight-item">üìç <strong>${topState.name}</strong> √© o estado com maior volume absoluto de garantias (${topState.value}).</div>`;
            }
        }

        container.innerHTML = html;
    }

    // ==========================================
    // 6. IMPORTA√á√ÉO E LIMPEZA
    // ==========================================
    
    function normalizeKeys(row) {
        const newRow = {};
        Object.keys(row).forEach(key => {
            let cleanKey = key.trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, ""); 
            newRow[cleanKey] = row[key];
        });
        return newRow;
    }

    function parseExcelDate(value) {
        if (!value) return null;
        if (typeof value === 'number') {
            return new Date(Math.round((value - 25569)*86400*1000));
        }
        if (typeof value === 'string') {
            const d = new Date(value);
            if(!isNaN(d)) return d;
            const parts = value.split('/');
            if(parts.length === 3) return new Date(parts[2], parts[1]-1, parts[0]);
        }
        return null;
    }

    async function handleFileUpload(event) {
        const files = event.target.files;
        if (!files || files.length === 0) return;
        document.getElementById('upload-status').innerText = "Processando...";
        
        let tempDB = { vendasRMA: [], defeitos: [], regional: [] };
        let filesProcessed = 0;

        for (let i = 0; i < files.length; i++) {
            const file = files[i];
            const fileName = file.name.toLowerCase();
            const reader = new FileReader();

            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, {type: 'array', cellDates: true});
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                
                const aoa = XLSX.utils.sheet_to_json(firstSheet, {header: 1, defval: ''});
                let headerRowIndex = 0;
                for(let r=0; r < Math.min(aoa.length, 20); r++) {
                    const rowStr = JSON.stringify(aoa[r]).toLowerCase();
                    if(rowStr.includes('fabricante') || rowStr.includes('produto') || rowStr.includes('estado')) {
                        headerRowIndex = r;
                        break;
                    }
                }

                let jsonData = XLSX.utils.sheet_to_json(firstSheet, {range: headerRowIndex, defval: ""});
                let normalizedData = jsonData.map(normalizeKeys);

                if (normalizedData.length > 0) {
                    const keys = Object.keys(normalizedData[0]);
                    
                    if (fileName.includes('vendas') || fileName.includes('modelos')) {
                        tempDB.vendasRMA = mapVendas(normalizedData);
                    } 
                    else if (fileName.includes('defeitos')) {
                        tempDB.defeitos = mapDefeitos(normalizedData);
                    }
                    else if (fileName.includes('regional') || fileName.includes('estados')) {
                        tempDB.regional = mapRegional(normalizedData);
                    }
                    else {
                        if (keys.some(k => k.includes('problematica'))) {
                            tempDB.defeitos = mapDefeitos(normalizedData);
                        } else if (keys.some(k => k.includes('estado'))) {
                            tempDB.regional = mapRegional(normalizedData);
                        } else if (keys.some(k => k.includes('total vendido'))) {
                            tempDB.vendasRMA = mapVendas(normalizedData);
                        }
                    }
                }
                filesProcessed++;
                if (filesProcessed === files.length) finalizeUpload(tempDB);
            };
            reader.readAsArrayBuffer(file);
        }
    }

    function mapVendas(data) {
        return data
            .filter(r => r['fabricante'] && r['produto']) 
            .map(row => {
                let dSale = row['data venda'] || row['dt venda'] || row['data da venda'] || row['date sale'] || null;
                let dRMA = row['data rma'] || row['data abertura'] || row['dt defeito'] || row['data abertura rma'] || null;

                let rmaVal = parseInt(row['quant. de sac'] || row['quant de sac']) || 0;
                if(rmaVal === 0 && dRMA) rmaVal = 1;

                return {
                    manufacturer: row['fabricante'],
                    product: row['produto'],
                    rma: rmaVal,
                    sales: parseInt(row['total vendido']) || 0,
                    dateSale: dSale ? parseExcelDate(dSale) : null,
                    dateRMA: dRMA ? parseExcelDate(dRMA) : null
                };
            });
    }

    function mapDefeitos(data) {
        return data
            .filter(r => r['fabricante'] && r['produto'])
            .map(row => ({
                manufacturer: row['fabricante'],
                product: row['produto'],
                defect: row['problematica'] || row['problem√°tica'],
                count: parseInt(row['quant. de sac'] || row['quant de sac']) || 0
            }));
    }

    function mapRegional(data) {
        return data
            .filter(r => r['fabricante'] && r['produto'])
            .map(row => ({
                manufacturer: row['fabricante'],
                product: row['produto'],
                state: row['estado'],
                rma: parseInt(row['quant. de sac'] || row['quant de sac']) || 0,
                sales: parseInt(row['total vendido']) || 0
            }));
    }

    function finalizeUpload(tempDB) {
        if(tempDB.vendasRMA.length > 0) DB.vendasRMA = tempDB.vendasRMA;
        if(tempDB.defeitos.length > 0) DB.defeitos = tempDB.defeitos;
        if(tempDB.regional.length > 0) DB.regional = tempDB.regional;
        
        init();
        updateDashboard();
    }

    // ==========================================
    // 7. EXPORTAR E RESTAURAR (MAGIC FEATURE)
    // ==========================================

    // Fun√ß√£o para baixar o pr√≥prio HTML com os dados injetados
    function exportStandaloneHTML() {
        // 1. Serializa os dados atuais
        const dataToSave = JSON.stringify(DB);
        
        // 2. Pega o c√≥digo fonte atual da p√°gina
        let htmlContent = document.documentElement.outerHTML;

        // 3. Injeta os dados na vari√°vel EMBEDDED_DATA dentro do script
        // Procura o placeholder inicial e substitui
        const scriptSearch = 'let EMBEDDED_DATA = null;';
        const scriptReplace = `let EMBEDDED_DATA = ${dataToSave};`;
        
        // Se j√° houve exporta√ß√£o anterior, substitui a vari√°vel populada
        const regexReplace = /let EMBEDDED_DATA = \{.*?\};/s;

        if (htmlContent.includes(scriptSearch)) {
            htmlContent = htmlContent.replace(scriptSearch, scriptReplace);
        } else {
            htmlContent = htmlContent.replace(regexReplace, scriptReplace);
        }

        // 4. Cria o blob e baixa
        const blob = new Blob([htmlContent], {type: 'text/html'});
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'dashboard-rma-com-dados.html';
        a.click();
    }

    function clearSavedData() {
        if(confirm("Deseja zerar todos os dados da tela?")) {
            DB = { vendasRMA: [], defeitos: [], regional: [] };
            state.filters = { manufacturers: [], models: [] };
            state.activeSelection = { type: null, value: null };
            
            // Limpa input
            const fileInput = document.getElementById('fileInput');
            if(fileInput) fileInput.value = "";
            
            document.getElementById('upload-status').innerText = "Nenhum dado carregado";
            document.getElementById('upload-status').style.color = "var(--text-muted)";
            document.getElementById('last-update').innerText = "Aguardando dados";
            document.getElementById('active-filters-container').innerHTML = '';
            document.getElementById('export-btn').style.display = "none";

            init(); 
        }
    }

    function init() {
        // Se houver dados embutidos (via exporta√ß√£o), carrega eles
        if (typeof EMBEDDED_DATA !== 'undefined' && EMBEDDED_DATA) {
            DB = EMBEDDED_DATA;
            document.getElementById('last-update').innerText = "Dados fixos carregados";
        }

        const manufSet = new Set();
        [...DB.vendasRMA, ...DB.defeitos, ...DB.regional].forEach(d => d.manufacturer && manufSet.add(d.manufacturer));
        const uniqueManuf = [...manufSet].sort();
        
        state.filters.manufacturers = [...uniqueManuf];
        renderCheckboxes('filter-manufacturers', uniqueManuf, 'manufacturers');
        
        updateModelList();
    }

    function renderCheckboxes(id, list, type) {
        const container = document.getElementById(id);
        container.innerHTML = '';
        if (list.length === 0 && type === 'manufacturers') {
            container.innerHTML = '<div style="padding:5px; color:#999; font-style:italic;">Nenhum dado</div>';
            return;
        }
        list.forEach(item => {
            const div = document.createElement('div');
            div.className = 'checkbox-item';
            const cb = document.createElement('input');
            cb.type = 'checkbox'; cb.id = `${type}-${item}`; cb.value = item;
            cb.checked = state.filters[type].includes(item);
            cb.onchange = () => handleFilterChange(type, item, cb.checked);
            const lbl = document.createElement('label');
            lbl.htmlFor = `${type}-${item}`; lbl.innerText = item;
            div.appendChild(cb); div.appendChild(lbl);
            container.appendChild(div);
        });
    }

    function handleFilterChange(type, val, checked) {
        if(checked) state.filters[type].push(val);
        else state.filters[type] = state.filters[type].filter(v => v !== val);
        if(type === 'manufacturers') updateModelList();
        else updateDashboard();
    }

    function toggleAll(type, val) {
        const container = document.getElementById(type === 'manufacturers' ? 'filter-manufacturers' : 'filter-models');
        const cbs = container.querySelectorAll('input');
        const all = [];
        cbs.forEach(cb => { cb.checked = val; if(val) all.push(cb.value); });
        state.filters[type] = all;
        if(type === 'manufacturers') updateModelList();
        else updateDashboard();
    }

    function updateModelList() {
        const modelsSet = new Set();
        const selManuf = state.filters.manufacturers;
        [...DB.vendasRMA, ...DB.defeitos, ...DB.regional].forEach(row => {
            if(row.product && selManuf.includes(row.manufacturer)) modelsSet.add(row.product);
        });
        const validModels = [...modelsSet].sort();
        state.filters.models = [...validModels];
        renderCheckboxes('filter-models', validModels, 'models');
        updateDashboard();
    }

    window.onload = init;
</script>

</body></html>